"use strict";(self.webpackChunkglpal=self.webpackChunkglpal||[]).push([[789],{9160(e,t,a){a.d(t,{$C:()=>r,QR:()=>n,db:()=>o,kz:()=>s});const o=[{id:"semaglutide",name:"Semaglutide (Ozempic/Wegovy)",defaultDose:.25,halfLifeHours:168,titrationDoses:[.25,.5,1,1.7,2.4]},{id:"tirzepatide",name:"Tirzepatide (Mounjaro/Zepbound)",defaultDose:2.5,halfLifeHours:127,titrationDoses:[2.5,5,7.5,10,12.5,15]},{id:"retatrutide",name:"Retatrutide",defaultDose:1,halfLifeHours:120,titrationDoses:[1,2,4,6,8,9,12]},{id:"cagrilintide",name:"Cagrilintide (Amycretin)",defaultDose:.25,halfLifeHours:168,titrationDoses:[.25,.5,1,1.5,2.4]},{id:"liraglutide",name:"Liraglutide (Victoza/Saxenda)",defaultDose:3,halfLifeHours:13},{id:"dulaglutide",name:"Dulaglutide (Trulicity)",defaultDose:4.5,halfLifeHours:108},{id:"other",name:"Custom",defaultDose:1,halfLifeHours:120}],r=()=>Math.random().toString(36).substr(2,9),s=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"}),n=e=>({7:"Everyday",3.5:"Every 2 days",2.333:"Every 3 days",2:"Every 3.5 days",1.75:"Every 4 days",1.4:"Every 5 days",1.167:"Every 6 days",1:"Weekly",.5:"Every 2 weeks",.333:"Every 3 weeks",.233:"Monthly"}[e]||"".concat(e,"x/week"))},8789(e,t,a){a.r(t),a.d(t,{default:()=>G});var o=a(5043),r=a(9396),s=a(9160),n=a(1235),i=a(2639),l=a(7596),d=a(5644),c=a(8907),m=a(8421),u=a(579);const x=()=>c.P.todayString(),g=e=>{let{isOpen:t,onClose:a,onAddMedication:r,useWheelForDate:c=!0}=e;const{isDarkMode:g}=(0,m.DP)(),[h,b]=(0,o.useState)(""),[p,f]=(0,o.useState)(""),[y,D]=(0,o.useState)(x()),[v,w]=(0,o.useState)(!1),[j,S]=(0,o.useState)(!1),[C,N]=(0,o.useState)(!1),[k,M]=(0,o.useState)(!1);if((0,o.useEffect)(()=>{if(t){D(x());const e=(0,n.kT)();e&&b(e)}},[t]),(0,o.useEffect)(()=>{if(h){const e=(0,n.tz)();if(e[h])f(e[h].toString());else{const e=s.db.find(e=>e.id===h);e&&f(e.defaultDose.toString())}}},[h]),(0,o.useEffect)(()=>{t?(N(!0),M(!1),document.body.classList.add("modal-open")):C&&!k&&(M(!0),setTimeout(()=>{N(!1),M(!1),document.body.classList.remove("modal-open")},200))},[t]),!C)return null;return(0,u.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[(0,u.jsx)("div",{className:"fixed inset-0 bg-black/60 ".concat(k?"backdrop-fade-out":"backdrop-fade-in"),style:{backdropFilter:"blur(8px)"},onClick:a}),(0,u.jsxs)("div",{className:"relative rounded-2xl shadow-2xl border border-[#B19CD9]/30 w-full max-w-sm p-6 max-h-[90vh] overflow-y-auto ".concat(g?"bg-gradient-to-b from-[#1a1625]/70 to-[#0d0a15]/95":"bg-white/95"," ").concat(k?"modal-fade-out":"modal-content-fade-in"),children:[(0,u.jsx)("h2",{className:"text-xl font-semibold mb-6 ".concat(g?"text-white":"text-gray-900"),children:"Log Dose"}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 mb-3"}),(0,u.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=parseFloat(p);h&&t&&t>0&&t<100&&((0,n.dr)(h),(0,n.xo)(h,t),r(t,h,y),b(""),f(""),a())},children:[(0,u.jsxs)("div",{className:"mb-4",children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Date"}),(0,u.jsxs)("div",{className:"relative",children:[(0,u.jsx)("input",{type:"text",value:y,readOnly:!0,onClick:()=>w(!0),className:"w-full px-3 py-2 pr-10 border rounded-lg cursor-pointer ".concat(g?"border-[#B19CD9]/30 bg-black/20 text-text-primary":"border-gray-300 bg-white text-gray-900"),placeholder:"Select date"}),(0,u.jsx)("svg",{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-text-muted pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})]}),v&&(c?(0,u.jsx)(i.A,{isOpen:v,value:y,onChange:D,onClose:()=>w(!1),maxDate:x()}):(0,u.jsx)(l.A,{isOpen:v,value:y,onChange:D,onClose:()=>w(!1)})),(0,u.jsx)(d.A,{isOpen:j,onSave:e=>{f(e),S(!1)},onClose:()=>S(!1),min:0,max:100,label:"Select Dose (mg)",decimals:2,defaultValue:p||"0.25"}),(0,u.jsxs)("div",{className:"mb-4",children:[(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-3"}),(0,u.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Medication"}),(0,u.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:s.db.map(e=>(0,u.jsx)("button",{type:"button",onClick:()=>(e=>{b(e);const t=(0,n.tz)();if(t[e])f(t[e].toString());else{const t=s.db.find(t=>t.id===e);t&&f(t.defaultDose.toString())}})(e.id),className:"w-full text-left px-3 py-2 rounded-lg transition-all ".concat(h===e.id?"bg-[#B19CD9]/30 border border-[#B19CD9]":g?"bg-black/20 border border-transparent hover:bg-[#B19CD9]/10":"bg-gray-100 border border-transparent hover:bg-gray-200"),children:(0,u.jsx)("span",{className:"text-sm text-text-primary",children:e.name})},e.id))})]}),(0,u.jsxs)("div",{className:"mb-4",children:[(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-3"}),(0,u.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Dose (mg)"}),(0,u.jsx)("button",{type:"button",onClick:()=>S(!0),className:"w-full px-3 py-2 border rounded-lg text-left ".concat(g?"border-[#B19CD9]/30 bg-black/20 text-text-primary":"border-gray-300 bg-white text-gray-900"),children:p?"".concat(p," mg"):"Select dose"}),(0,u.jsx)("p",{className:"text-xs text-[#4ADEA8] mt-1",children:"Enter only the dose prescribed by your healthcare provider."})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-3"}),(0,u.jsxs)("div",{className:"flex gap-3",children:[(0,u.jsx)("button",{type:"button",onClick:a,className:"flex-1 py-3 rounded-xl border transition-all font-medium ".concat(g?"border-[#B19CD9]/40 text-white/80 hover:text-white hover:bg-white/10":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"}),(0,u.jsx)("button",{type:"submit",className:"flex-1 py-3 rounded-xl bg-gradient-to-r from-[#B19CD9] to-[#9C7BD3] text-white font-medium hover:shadow-[0_0_20px_rgba(177,156,217,0.5)] transition-all",children:"Log Dose"})]})]})]})]})};var h=a(8171);const b=["Abdomen","Thigh","Arm","Buttock"],p=["Left","Right"],f=["Upper","Middle","Lower"],y=["None","Mild","Moderate","Severe"],D=e=>{let{isOpen:t,onClose:a,onSave:r,protocol:s,allMedications:i=[]}=e;const{isDarkMode:l}=(0,m.DP)(),d=(0,o.useMemo)(()=>null!==s&&void 0!==s&&s.medication&&0!==i.length?(0,h.F_)(s.medication,i).stroke:"#B19CD9",[null===s||void 0===s?void 0:s.medication,i]),[x,g]=(0,o.useState)(0),[D,v]=(0,o.useState)(""),[w,j]=(0,o.useState)(""),[S,C]=(0,o.useState)(""),[N,k]=(0,o.useState)("None"),[M,B]=(0,o.useState)(""),[T,L]=(0,o.useState)(!1),[A,O]=(0,o.useState)(!1),[E,I]=(0,o.useState)(""),F=(0,o.useCallback)(e=>{g(e)},[]);(0,o.useEffect)(()=>{if(t){const e=c.P.nowDate();I(e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})),g(0),v(""),j(""),C(""),k("None"),B(""),L(!0),O(!1),document.body.classList.add("modal-open")}else T&&!A&&(O(!0),setTimeout(()=>{L(!1),O(!1),document.body.classList.remove("modal-open")},200))},[t,T,A]);const _=(0,o.useMemo)(()=>{return 0===(e=x)?"#4ade80":e<=3?"#facc15":e<=6?"#fb923c":"#f87171";var e},[x]);if(!T)return null;const z=c.P.nowDate().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),P=()=>{const e=[];return w&&e.push(w),S&&e.push(S),D&&e.push(D),e.join(" ")},W=function(e,t,a,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;return(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-text-primary mb-2",children:e}),(0,u.jsx)("div",{className:"grid gap-2",style:{gridTemplateColumns:"repeat(".concat(r,", minmax(0, 1fr))")},children:t.map(e=>(0,u.jsx)("button",{type:"button",onClick:()=>o(a===e?"":e),className:"py-2 rounded-lg text-xs font-medium transition-all duration-300 transform hover:scale-[1.02] ".concat(a===e?"bg-gradient-to-r from-[#B19CD9] to-[#9C7BD3] text-white shadow-[0_0_10px_rgba(177,156,217,0.4)]":l?"bg-black/20 border border-[#B19CD9]/30 text-text-muted hover:bg-[#B19CD9]/20 hover:border-[#B19CD9]/50":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-100"),children:e},e))})]})};return(0,u.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[(0,u.jsx)("div",{className:"fixed inset-0 bg-black/60 ".concat(A?"backdrop-fade-out":"backdrop-fade-in"),style:{backdropFilter:"blur(8px)"},onClick:a}),(0,u.jsxs)("div",{className:"relative rounded-2xl shadow-2xl border border-[#B19CD9]/30 w-full max-w-sm p-6 max-h-[90vh] overflow-y-auto pointer-events-auto ".concat(l?"bg-gradient-to-b from-[#1a1625]/70 to-[#0d0a15]/95":"bg-white/95"," ").concat(A?"modal-fade-out":"modal-content-fade-in"),children:[(0,u.jsx)("h2",{className:"text-xl font-semibold mb-2 ".concat(l?"text-white":"text-gray-900"),children:"Log Dose"}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 mb-4"}),(0,u.jsx)("div",{className:"space-y-3 mb-4",children:(0,u.jsxs)("div",{className:"rounded-lg p-3 border ".concat(l?"bg-black/20 border-[#B19CD9]/20":"bg-gray-50 border-gray-200"),children:[(0,u.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,u.jsx)("span",{className:"text-sm text-text-secondary",children:"Medication"}),(0,u.jsx)("span",{className:"text-sm font-medium",style:{color:d},children:(null===s||void 0===s?void 0:s.medication)||"N/A"})]}),(0,u.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,u.jsx)("span",{className:"text-sm text-text-secondary",children:"Date"}),(0,u.jsx)("span",{className:"text-sm text-text-primary",children:z})]}),(0,u.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,u.jsx)("span",{className:"text-sm text-text-secondary",children:"Time"}),(0,u.jsx)("span",{className:"text-sm font-medium text-text-primary",children:E})]}),(0,u.jsxs)("div",{className:"flex justify-between items-center",children:[(0,u.jsx)("span",{className:"text-sm text-text-secondary",children:"Dose"}),(0,u.jsxs)("span",{className:"text-sm font-medium text-[#4ADEA8]",children:[(null===s||void 0===s?void 0:s.dose)||0,"mg"]})]})]})}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 mb-4"}),(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,u.jsx)("label",{className:"text-sm font-medium text-text-secondary",children:"Pain Level (optional)"}),(0,u.jsxs)("span",{className:"pain-level-indicator text-sm font-medium",style:{color:_},children:[x,"/10"]})]}),(0,u.jsxs)("div",{className:"flex flex-col",children:[(0,u.jsx)("input",{type:"range",min:"0",max:"10",step:"1",value:x,onChange:e=>F(parseInt(e.target.value)),className:"pain-slider w-full h-10 appearance-none cursor-pointer"}),(0,u.jsxs)("div",{className:"flex justify-between gap-1 mt-1",children:[(0,u.jsx)("span",{className:"text-xs text-green-400",children:"None"}),(0,u.jsx)("span",{className:"text-xs text-orange-400",children:"Moderate"}),(0,u.jsx)("span",{className:"text-xs text-red-400",children:"Severe"})]})]})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-4"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Injection Site (optional)"}),W("Area",b,D,v,4),(0,u.jsx)("div",{className:"mt-2",children:W("Side",p,w,j,2)}),(0,u.jsx)("div",{className:"mt-2",children:W("Position",f,S,C,3)}),P()&&(0,u.jsx)("div",{className:"mt-3 text-center",children:(0,u.jsxs)("span",{className:"text-sm bg-[#4ADEA8]/20 text-[#4ADEA8] px-3 py-1 rounded-lg",children:["Selected: ",P()]})})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-4"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Injection Site Reaction (optional)"}),(0,u.jsx)("div",{className:"flex gap-2",children:y.map(e=>(0,u.jsx)("button",{type:"button",onClick:()=>k(e),className:"flex-1 py-2 rounded-lg text-xs font-medium transition-all duration-300 transform hover:scale-[1.02] ".concat(N===e?"None"===e?"bg-gradient-to-r from-[#4ADEA8] to-[#6EE7B7] text-white shadow-[0_0_10px_rgba(74,222,168,0.4)]":"Mild"===e?"bg-gradient-to-r from-[#EAB308] to-[#FACC15] text-white shadow-[0_0_10px_rgba(234,179,8,0.4)]":"Moderate"===e?"bg-gradient-to-r from-[#F97316] to-[#FB923C] text-white shadow-[0_0_10px_rgba(249,115,22,0.4)]":"bg-gradient-to-r from-[#EF4444] to-[#F87171] text-white shadow-[0_0_10px_rgba(239,68,68,0.4)]":l?"bg-black/20 border border-[#B19CD9]/30 text-text-muted hover:bg-[#B19CD9]/20 hover:border-[#B19CD9]/50":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-100"),children:e},e))})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-4"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Notes (optional)"}),(0,u.jsx)("textarea",{value:M,onChange:e=>B(e.target.value),placeholder:"Any additional notes...",className:"w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:border-[#B19CD9]/60 resize-y ".concat(l?"bg-black/30 border-[#B19CD9]/30 text-text-primary placeholder-text-muted":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"),rows:2})]})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-4"}),(0,u.jsxs)("div",{className:"flex gap-3",children:[(0,u.jsx)("button",{type:"button",onClick:a,className:"flex-1 py-3 rounded-xl border transition-all font-medium ".concat(l?"border-[#B19CD9]/40 text-white/80 hover:text-white hover:bg-white/10":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"}),(0,u.jsx)("button",{type:"button",onClick:()=>{if(!s)return;const e=c.P.todayString(),t=P(),o={date:e,medication:s.medication,dose:s.dose,halfLifeHours:s.halfLifeHours,isManual:!0,time:E,painLevel:x>0?x:void 0,injectionSite:t||void 0,isr:"None"!==N?N:void 0,notes:M||void 0};(0,n.D4)(o),r(),a()},className:"flex-1 py-3 rounded-xl bg-gradient-to-r from-[#4ADEA8] to-[#4FD99C] text-white font-medium hover:shadow-[0_0_20px_rgba(74,222,168,0.5)] transition-all",children:"Save"})]})]})]})};var v=a(5109),w=a(1288),j=a(2555);const S=()=>c.P.todayString(),C=e=>{const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(o)},N=e=>{let{isOpen:t,mode:a,protocol:r,existingProtocols:n}=e;const[i,l]=(0,o.useState)(""),[d,c]=(0,o.useState)(""),[m,u]=(0,o.useState)("1"),[x,g]=(0,o.useState)(S()),[h,b]=(0,o.useState)(""),[p,f]=(0,o.useState)(null),[y,D]=(0,o.useState)(void 0),[v,w]=(0,o.useState)(()=>{const e=localStorage.getItem("protocolDurationDays");return e?parseInt(e,10):28}),[N,k]=(0,o.useState)(!1),[M,B]=(0,o.useState)(""),[T,L]=(0,o.useState)([]);(0,o.useEffect)(()=>{if(t){const e=(()=>{const e=["Semaglutide (Ozempic/Wegovy)","Tirzepatide (Mounjaro/Zepbound)","Retatrutide"];if(n&&n.length>0){const t=Array.from(new Set(n.map(e=>e.medication))).filter(t=>e.includes(t)||"Semaglutide (Ozempic/Wegovy)"!==t&&"Tirzepatide (Mounjaro/Zepbound)"!==t&&"Retatrutide"!==t&&"More Options"!==t);return L(t),localStorage.setItem("usedMedications",JSON.stringify(t)),t}{const e=localStorage.getItem("usedMedications");if(e){const t=JSON.parse(e);return L(t),t}return L([]),[]}})();if("edit"===a&&r){const e=s.db.find(e=>e.name===r.medication);l(e?e.id:r.medication),c(r.dose.toString()),u(r.frequencyPerWeek.toString()),g(r.startDate),b(r.stopDate||""),f(null),D(r.phase),k(!1),B("")}else if("add"===a){const t=localStorage.getItem("protocolDurationDays"),a=t?parseInt(t,10):28;if(e&&e.length>0){const t=e[e.length-1],o=s.db.find(e=>e.name===t);if(o){const e=o.id,t=o;let r=t.defaultDose.toString(),s=S(),i=null,d=!1;const m=(n||[]).filter(a=>a.medication===t.name||a.medication===e);if(m.length>0){const e=[...m].sort((e,t)=>e.stopDate?t.stopDate?new Date(t.stopDate).getTime()-new Date(e.stopDate).getTime():-1:1)[0];if(e.stopDate){const o=new Date(e.stopDate);s=C(o),i="Continues from ".concat(t.name," protocol (ended ").concat(e.stopDate,")");const r=new Date(s);r.setDate(r.getDate()+a),b(C(r))}else{i="Continues from ".concat(t.name," protocol (ongoing)");const e=new Date(s);e.setDate(e.getDate()+a),b(C(e))}if(t.titrationDoses){const a=t.titrationDoses.indexOf(e.dose);a>=0&&a<t.titrationDoses.length-1&&(r=t.titrationDoses[a+1].toString(),d=!0)}}l(e),g(s),c(r),f(i),D(d?"titrate":void 0),u("1")}else{l(""),c(""),u("1");const e=S();g(e);const t=new Date(new Date(e).getTime()+24*a*60*60*1e3);b(C(t)),f(null),D(void 0)}}else{l(""),c(""),u("1");const e=S();g(e);const t=new Date(new Date(e).getTime()+24*a*60*60*1e3);b(C(t)),f(null),D(void 0)}k(!1),B("")}}},[t,a,r,n]);const A=()=>["semaglutide","tirzepatide","retatrutide","other",...T.filter(e=>!["Semaglutide (Ozempic/Wegovy)","Tirzepatide (Mounjaro/Zepbound)","Retatrutide"].includes(e)).map(e=>{const t=s.db.find(t=>t.name===e);return t?t.id:null}).filter(Boolean)],O=(0,o.useMemo)(()=>s.db.filter(e=>A().includes(e.id)).map(e=>"other"===e.id?(0,j.A)((0,j.A)({},e),{},{name:"More Options"}):e),[T]);(0,o.useEffect)(()=>{localStorage.setItem("protocolDurationDays",v.toString())},[v]);return{selectedMedication:i,setSelectedMedication:l,dose:d,setDose:c,frequency:m,setFrequency:u,startDate:x,setStartDate:g,stopDate:h,setStopDate:b,continuationInfo:p,setContinuationInfo:f,phase:y,setPhase:D,selectedDurationDays:v,setSelectedDurationDays:w,customMedication:M,setCustomMedication:B,savedMedications:T,showOtherModal:N,setShowOtherModal:k,MAIN_MEDICATIONS:O,getAllMedicationIds:A,applyMedicationDefaults:e=>{const t=s.db.find(t=>t.id===e);if(!t)return;let o=t.defaultDose.toString(),r=S(),i=!1;if("add"===a&&n){const a=t.name,s=n.filter(t=>t.medication===a||t.medication===e);if(s.length>0){const e=[...s].sort((e,t)=>e.stopDate?t.stopDate?new Date(t.stopDate).getTime()-new Date(e.stopDate).getTime():-1:1)[0];if(e.stopDate){const a=new Date(e.stopDate);r=C(a),f("Continues from ".concat(t.name," protocol (ended ").concat(e.stopDate,")"));const o=new Date(r);o.setDate(o.getDate()+v),b(C(o))}else{r=S(),f("Continues from ".concat(t.name," protocol (ongoing)"));const e=new Date(r);e.setDate(e.getDate()+v),b(C(e))}if(t.titrationDoses){const a=t.titrationDoses.indexOf(e.dose);a>=0&&a<t.titrationDoses.length-1&&(o=t.titrationDoses[a+1].toString(),i=!0)}}else f(null)}l(e),g(r),c(o),D(i?"titrate":void 0)},handleSave:()=>{const e=s.db.find(e=>e.id===i);if(!d||!m||!x)return null;let t=i,a=120;if(i.startsWith("custom:")){t=i.replace("custom:","");const e=JSON.parse(localStorage.getItem("usedMedications")||"[]");if(!e.includes(t)){const a=[...e,t];localStorage.setItem("usedMedications",JSON.stringify(a)),L(a)}}else{if(!e)return null;{t=e.name,a=e.halfLifeHours;const o=JSON.parse(localStorage.getItem("usedMedications")||"[]");if(!o.includes(e.name)){const t=[...o,e.name];localStorage.setItem("usedMedications",JSON.stringify(t)),L(t)}}}const o=h||C(new Date(new Date(x).getTime()+31536e6));return{id:(null===r||void 0===r?void 0:r.id)||(0,s.$C)(),medication:t,dose:parseFloat(d),frequencyPerWeek:parseInt(m),startDate:x,stopDate:o,halfLifeHours:a,phase:y}},resetForm:()=>{l(""),c(""),u("1"),g(S()),b(""),f(null),D(void 0),k(!1),B("")}}},k=[{value:"7",label:"Everyday"},{value:"3.5",label:"Every 2 Days"},{value:"2.333",label:"Every 3 Days"},{value:"2",label:"Every 3.5 Days"},{value:"1.75",label:"Every 4 Days"},{value:"1.4",label:"Every 5 Days"},{value:"1.167",label:"Every 6 Days"},{value:"1",label:"Every Week"},{value:"0.5",label:"Every 2 Weeks"},{value:"0.333",label:"Every 3 Weeks"},{value:"0.233",label:"Every Month"}],M=[{label:"1W",days:7},{label:"2W",days:14},{label:"1M",days:28},{label:"1Y",days:336}],B=e=>{var t;let{isOpen:a,onClose:r,onSave:n,onArchive:c,onDelete:x,protocol:g,mode:h,existingProtocols:b,useWheelForNumbers:p=!0,useWheelForDate:f=!0}=e;const{isDarkMode:y}=(0,m.DP)(),[D,v]=(0,o.useState)(null),[j,S]=(0,o.useState)(!1),[B,T]=(0,o.useState)(!1),[L,A]=(0,o.useState)(!1),[O,E]=(0,o.useState)(!1),[I,F]=(0,o.useState)(!1),[_,z]=(0,o.useState)(!1),{selectedMedication:P,setSelectedMedication:W,dose:Y,setDose:H,frequency:U,setFrequency:R,startDate:q,setStartDate:J,stopDate:V,setStopDate:G,continuationInfo:Z,setContinuationInfo:$,selectedDurationDays:K,setSelectedDurationDays:Q,customMedication:X,setCustomMedication:ee,showOtherModal:te,setShowOtherModal:ae,MAIN_MEDICATIONS:oe,getAllMedicationIds:re,applyMedicationDefaults:se,handleSave:ne}=N({isOpen:a,mode:h,protocol:g,existingProtocols:b});if((0,o.useEffect)(()=>{a?(F(!0),z(!1),document.body.classList.add("modal-open")):I&&!_&&(z(!0),setTimeout(()=>{F(!1),z(!1),document.body.classList.remove("modal-open")},200))},[a]),!I)return null;const ie=e=>{if(J(e),$(null),K&&e){const t=new Date(new Date(e).getTime()+24*K*60*60*1e3);G(C(t))}};return(0,u.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[(0,u.jsx)("div",{className:"fixed inset-0 bg-black/60 ".concat(_?"backdrop-fade-out":"backdrop-fade-in"),style:{backdropFilter:"blur(8px)"},onClick:r}),(0,u.jsxs)("div",{className:"relative rounded-2xl shadow-2xl border border-[#B19CD9]/30 w-full max-w-sm p-6 max-h-[90vh] overflow-y-auto ".concat(y?"bg-gradient-to-b from-[#1a1625]/70 to-[#0d0a15]/95":"bg-white/95"," ").concat(_?"modal-fade-out":"modal-content-fade-in"),children:[(0,u.jsx)("h2",{className:"text-xl font-semibold mb-6 ".concat(y?"text-white":"text-gray-900"),children:"add"===h?"Add Custom Plan":"Edit Protocol"}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 mb-3"}),(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium mb-2 ".concat(y?"text-white":"text-gray-700"),children:"Medication"}),(0,u.jsx)("div",{className:"grid grid-cols-2 gap-2",children:oe.map(e=>(0,u.jsx)("button",{type:"button",onClick:()=>{var t;"other"===(t=e.id)?ae(!0):se(t)},className:"text-left px-3 py-2 rounded-lg transition-all text-sm ".concat(P===e.id?"bg-[#B19CD9]/30 border border-[#B19CD9]":y?"bg-black/20 border border-transparent hover:bg-[#B19CD9]/10":"bg-gray-100 border border-transparent hover:bg-gray-200"),children:(0,u.jsx)("span",{className:y?"text-text-primary":"text-gray-900",children:e.name})},e.id))})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-3"}),(0,u.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium mb-2 ".concat(y?"text-white":"text-gray-700"),children:"Dose (mg)"}),p?(0,u.jsx)("button",{type:"button",onClick:()=>A(!0),className:"w-full px-3 py-2 border rounded-lg text-sm text-left ".concat(y?"border-[#B19CD9]/30 bg-black/20 text-[#B19CD9]":"border-gray-300 bg-white text-gray-700"),children:Y?"".concat(Y," mg"):"Select dose"}):(0,u.jsx)("input",{type:"number",step:"0.25",value:Y||"",onChange:e=>H(e.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm ".concat(y?"border-[#B19CD9]/30 bg-black/20 text-[#B19CD9]":"border-gray-300 bg-white text-gray-700"),placeholder:"Enter dose"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium mb-2 ".concat(y?"text-white":"text-gray-700"),children:"Dosing Schedule"}),(0,u.jsx)("button",{type:"button",onClick:()=>E(!0),className:"w-full px-3 py-2 border rounded-lg text-sm text-left ".concat(y?"border-[#B19CD9]/30 bg-black/20 text-[#B19CD9]":"border-gray-300 bg-white text-gray-700"),children:(null===(t=k.find(e=>e.value===U))||void 0===t?void 0:t.label)||"Select schedule"})]}),(0,u.jsx)("p",{className:"col-span-2 text-xs text-[#4ADEA8] mt-1",children:"Pre-filled with official label dose. Enter only the dose prescribed by your healthcare provider."})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-3"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium mb-2 ".concat(y?"text-white":"text-gray-700"),children:"Start Date"}),(0,u.jsx)("button",{type:"button",onClick:()=>S(!0),className:"w-full px-3 py-2 border rounded-lg text-sm text-left ".concat(y?"border-[#B19CD9]/30 bg-black/20 text-[#B19CD9]":"border-gray-300 bg-white text-gray-700"),children:q?new Date(q).toLocaleDateString():"Select date"}),Z&&(0,u.jsx)("p",{className:"text-xs text-[#4ADEA8] mt-1",children:Z}),(0,u.jsx)("div",{className:"flex gap-2 mt-2",children:M.map(e=>{const t=K===e.days;return(0,u.jsx)("button",{type:"button",onClick:()=>(e=>{if(Q(e),q){const t=new Date(new Date(q).getTime()+24*e*60*60*1e3);G(C(t))}})(e.days),className:"flex-1 px-3 py-1 text-xs rounded-lg transition-all duration-300 ".concat(t?"bg-gradient-to-r from-[#B19CD9] to-[#9C7BD3] text-white shadow-[0_0_15px_rgba(177,156,217,0.4)]":y?"bg-[#B19CD9]/10 text-[#B19CD9] border border-[#B19CD9]/30 hover:bg-[#B19CD9]/20 hover:shadow-[0_0_10px_rgba(177,156,217,0.3)]":"bg-gray-200 text-gray-700 border border-gray-300 hover:bg-gray-300"),children:e.label},e.label)})})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium mb-2 ".concat(y?"text-white":"text-gray-700"),children:"End Date"}),(0,u.jsx)("button",{type:"button",onClick:()=>T(!0),className:"w-full px-3 py-2 border rounded-lg text-sm text-left ".concat(y?"border-[#B19CD9]/30 bg-black/20 text-[#B19CD9]":"border-gray-300 bg-white text-gray-700"),children:V?new Date(V).toLocaleDateString():"Select date"})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-3"}),(0,u.jsxs)("div",{className:"flex gap-2",children:["edit"===h&&x&&c&&!D&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("button",{onClick:()=>v("archive"),className:"flex-1 px-4 py-2 rounded-lg border transition-all text-sm ".concat(y?"border-[#B19CD9]/30 text-white hover:bg-[#B19CD9]/10":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Archive"}),(0,u.jsx)("button",{onClick:()=>v("delete"),className:"flex-1 px-4 py-2 rounded-lg border border-red-500/30 text-red-400 hover:bg-red-500/10 transition-all text-sm",children:"Delete"})]}),"edit"===h&&D&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("button",{onClick:()=>{g&&"archive"===D&&c&&c(g),g&&"delete"===D&&x&&x(g.id),r()},className:"flex-1 px-4 py-2 rounded-lg border border-red-500/30 text-red-400 hover:bg-red-500/10 transition-all text-sm",children:["Yes, ",D]}),(0,u.jsx)("button",{onClick:()=>v(null),className:"flex-1 px-4 py-2 rounded-lg border transition-all text-sm ".concat(y?"border-[#B19CD9]/30 text-white hover:bg-[#B19CD9]/10":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"})]}),"add"===h&&(0,u.jsx)("button",{onClick:r,className:"flex-1 px-4 py-2 rounded-lg border transition-all text-sm ".concat(y?"border-[#B19CD9]/30 text-white hover:bg-[#B19CD9]/10":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"}),!D&&(0,u.jsx)("button",{onClick:()=>{const e=ne();e&&(n(e),r())},className:"".concat("flex-1"," bg-gradient-to-r from-accent-purple-light to-accent-purple-medium text-white py-2 px-4 rounded-lg hover:shadow-theme transition-all text-sm"),children:"Save"})]})]})]}),te&&(0,u.jsxs)("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4",children:[(0,u.jsx)("div",{className:"fixed inset-0 bg-black/60 ".concat(te?"backdrop-fade-in":"backdrop-fade-out"),style:{backdropFilter:"blur(8px)"},onClick:()=>ae(!1)}),(0,u.jsxs)("div",{className:"relative rounded-2xl shadow-2xl border border-[#B19CD9]/30 w-full max-w-xs p-6 max-h-[90vh] overflow-y-auto ".concat(y?"bg-gradient-to-b from-[#1a1625]/70 to-[#0d0a15]/95":"bg-white/95"," modal-content-fade-in"),children:[(0,u.jsx)("h3",{className:"text-lg font-semibold mb-4 ".concat(y?"text-white":"text-gray-900"),children:"Select Medication"}),(0,u.jsx)("div",{className:"space-y-2 mb-4",children:s.db.filter(e=>!re().includes(e.id)||"other"===e.id).map(e=>(0,u.jsx)("button",{type:"button",onClick:()=>{se(e.id),ae(!1)},className:"w-full text-left px-3 py-2 rounded-lg transition-all text-sm ".concat(P===e.id?"bg-[#B19CD9]/30 border border-[#B19CD9]":y?"bg-black/20 border border-transparent hover:bg-[#B19CD9]/10":"bg-gray-100 border border-transparent hover:bg-gray-200"),children:(0,u.jsx)("span",{className:y?"text-text-primary":"text-gray-900",children:e.name})},e.id))}),(0,u.jsxs)("div",{className:"border-t border-[#B19CD9]/20 pt-4",children:[(0,u.jsx)("label",{className:"block text-sm font-medium mb-2 ".concat(y?"text-[#B19CD9]":"text-[#9C7BD3]"),children:"Or enter custom medication"}),(0,u.jsx)("input",{type:"text",value:X,onChange:e=>ee(e.target.value),placeholder:"Custom medication name",className:"w-full px-3 py-2 border rounded-lg text-sm mb-2 ".concat(y?"border-[#B19CD9]/30 bg-black/20 text-white":"border-gray-300 bg-white text-gray-900")}),(0,u.jsx)("button",{onClick:()=>{X.trim()&&(W("custom:"+X.trim()),H("1"),ae(!1))},disabled:!X.trim(),className:"w-full bg-gradient-to-r from-accent-purple-light to-accent-purple-medium text-white py-2 px-4 rounded-lg hover:shadow-theme transition-all text-sm disabled:opacity-50",children:"Add Custom"})]})]})]}),j&&(f?(0,u.jsx)(i.A,{isOpen:j,value:q,onChange:ie,onClose:()=>S(!1)}):(0,u.jsx)(l.A,{isOpen:j,value:q,onChange:ie,onClose:()=>S(!1)})),B&&(f?(0,u.jsx)(i.A,{isOpen:B,value:V,onChange:e=>G(e),onClose:()=>T(!1)}):(0,u.jsx)(l.A,{isOpen:B,value:V,onChange:e=>G(e),onClose:()=>T(!1)})),L&&(0,u.jsx)(d.A,{isOpen:L,onSave:e=>{H(e),A(!1)},onClose:()=>A(!1),min:0,max:100,label:"Select Dose (mg)",decimals:2,defaultValue:Y||"0.25"}),(0,u.jsx)(w.A,{isOpen:O,title:"Dosing Schedule",options:k,value:U,onSelect:e=>{R(String(e)),E(!1)},onClose:()=>E(!1)})]})};const T=["variant","size","fullWidth","className","children"],L=e=>{let{variant:t="accent",size:a="md",fullWidth:o=!1,className:r="",children:s}=e,n=function(e,t){if(null==e)return{};var a,o,r=function(e,t){if(null==e)return{};var a={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==t.indexOf(o))continue;a[o]=e[o]}return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)a=s[o],-1===t.indexOf(a)&&{}.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}(e,T);return(0,u.jsx)("button",(0,j.A)((0,j.A)({className:"".concat("rounded-lg transition-all duration-300 transform hover:scale-[1.02]"," ").concat({primary:"bg-gradient-to-r from-accent-purple-light to-accent-purple-medium text-white shadow-theme hover:shadow-theme-lg hover:from-accent-purple-dark hover:to-accent-purple-medium",accent:"bg-gradient-to-r from-[#B19CD9] to-[#9C7BD3] text-white shadow-[0_0_10px_rgba(177,156,217,0.4)]",mint:"bg-gradient-to-r from-[#4ADEA8] to-[#4FD99C] text-white shadow-[0_0_15px_rgba(74,222,168,0.4)]"}[t]," ").concat({sm:"px-3 py-1 text-xs",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}[a]," ").concat(o?"w-full":""," ").concat(r)},n),{},{children:s}))},A=(0,o.memo)(L),O={semaglutide:["semaglutide","ozempic","wegovy"],tirzepatide:["tirzepatide","mounjaro","zepbound"],retatrutide:["retatrutide"],cagrilintide:["cagrilintide","amycretin"]},E=["semaglutide","tirzepatide","retatrutide","cagrilintide"],I=e=>{const t=e.toLowerCase();for(const[a,o]of Object.entries(O))if(o.some(e=>t.includes(e)))return a;return null},F=o.lazy(()=>a.e(398).then(a.bind(a,6398))),_=e=>{let{medicationEntries:t,protocols:a,currentTime:r,latestDoseDone:s,medicationName:n,onLogDose:i,isLogging:l,allMedications:d}=e;const{stats:m,activeProtocol:x,doseLoggedToday:g}=(0,o.useMemo)(()=>((e,t,a,o,r)=>{const s=e=>{const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(o)},n=e=>{const[t,a,o]=e.split("-").map(Number);return new Date(t,a-1,o).getTime()},i=new Date(a),l=s(i),d=null===t||void 0===t?void 0:t.filter(e=>e.medication===r&&!e.isArchived),m=e.filter(e=>e.medication===r),u=null===d||void 0===d?void 0:d.find(e=>{const t=e.startDate,a=e.stopDate||"2099-12-31";return l>=t&&l<=a});let x=7;u&&(x=Math.round(7/u.frequencyPerWeek)),[...m].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime());let g=null,h=0,b=0,p=0,f=0,y=0,D="N/A",v=null;const w=(null===u||void 0===u?void 0:u.startDate)||"",j=i.getTime();if(u&&w){const e=n(w),t=n(l),a=24*x*60*60*1e3,o=Math.floor((t-e)/864e5),r=e+(Math.floor(o/x)+(0===o%x?0:1))*a,s=r-a;g=new Date(s),v=new Date(r),y=(i.getTime()-s)/864e5;const d=r-j;h=Math.floor(d/864e5),b=Math.floor(d%864e5/36e5),p=Math.floor(d%36e5/6e4),f=Math.floor(d%6e4/1e3),D=v.toLocaleDateString("en-US",{month:"short",day:"numeric"})}const S=g,C=S?S.toLocaleDateString("en-US",{month:"short",day:"numeric"}):"N/A";if(!u&&S){y=(i.getTime()-S.getTime())/864e5,v=new Date(S.getTime()+24*x*60*60*1e3),D=v.toLocaleDateString("en-US",{month:"short",day:"numeric"});const e=v.getTime()-i.getTime();h=Math.floor(e/864e5),b=Math.floor(e%864e5/36e5),p=Math.floor(e%36e5/6e4),f=Math.floor(e%6e4/1e3),e<0&&0===h&&(b=Math.ceil(e/36e5),b<0&&(h=-1,b=24+b))}const N=m.length,k=m.length>0?m[0].dose:0,M=m.filter(e=>{const t=new Date(e.date);return t.getMonth()===i.getMonth()&&t.getFullYear()===i.getFullYear()}).length,B=(()=>{if(!d||0===d.length)return 0;const e=new Date(i);e.setMonth(e.getMonth()+1);let t=0;return d.forEach(a=>{const o=new Date(a.startDate),r=a.stopDate?new Date(a.stopDate):e,s=7/a.frequencyPerWeek;let n=new Date(o);for(;n<=r&&n<=e;)n>i&&t++,n=new Date(n.getTime()+24*s*60*60*1e3)}),t})(),T=!(!u||u.startDate!==l),L=(v?s(v):null)===l,A=((e,t)=>{const a={semaglutide:{isOverdue:!1,daysSinceLastDose:0,entryToday:!1},tirzepatide:{isOverdue:!1,daysSinceLastDose:0,entryToday:!1},retatrutide:{isOverdue:!1,daysSinceLastDose:0,entryToday:!1},cagrilintide:{isOverdue:!1,daysSinceLastDose:0,entryToday:!1}},o=new Date(t),r=s(o),n=new Date(o.getFullYear(),o.getMonth(),o.getDate());for(const s of E){const t=e.filter(e=>I(e.medication)===s&&e.isManual);if(0===t.length){a[s]={isOverdue:!1,daysSinceLastDose:0,entryToday:!1};continue}const o=[...t].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())[0];if(!o)continue;const[i,l,d]=o.date.split("-").map(Number),c=new Date(i,l-1,d),m=Math.floor((n.getTime()-c.getTime())/864e5);a[s]={isOverdue:m>=8,daysSinceLastDose:m,entryToday:t.some(e=>e.date===r)}}return a})(e,a),O={totalDoses:N,currentDoses:[],totalCurrentDose:k,nextDueDays:h,nextDueHours:b,nextDueMinutes:p,nextDueSeconds:f,nextDueDateStr:D,currentLevel:0,thisMonth:M,plannedDoses:B,lastDoseDateStr:C,daysSinceLastDose:y,intervalDays:x,isScheduleStartDay:T,isDueToday:L,latestDoseDone:o,isOverdue:(()=>{if(0===m.length)return!1;const e=[...m].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())[0];if(!e)return!1;const t=new Date(e.date),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),o=new Date(i.getFullYear(),i.getMonth(),i.getDate());return Math.floor((o.getTime()-a.getTime())/864e5)>=8})(),actualDaysSinceLastDose:(()=>{if(0===m.length)return 0;const e=[...m].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())[0];if(!e)return 0;const t=new Date(e.date),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),o=new Date(i.getFullYear(),i.getMonth(),i.getDate());return Math.floor((o.getTime()-a.getTime())/864e5)})(),semaglutideIsOverdue:A.semaglutide.isOverdue,tirzepatideIsOverdue:A.tirzepatide.isOverdue,retatrutideIsOverdue:A.retatrutide.isOverdue,cagrilintideIsOverdue:A.cagrilintide.isOverdue,semaglutideEntryToday:A.semaglutide.entryToday,tirzepatideEntryToday:A.tirzepatide.entryToday,retatrutideEntryToday:A.retatrutide.entryToday,cagrilintideEntryToday:A.cagrilintide.entryToday,semaglutideDaysSinceLastDose:A.semaglutide.daysSinceLastDose,tirzepatideDaysSinceLastDose:A.tirzepatide.daysSinceLastDose,retatrutideDaysSinceLastDose:A.retatrutide.daysSinceLastDose,cagrilintideDaysSinceLastDose:A.cagrilintide.daysSinceLastDose},F=c.P.todayString();return{stats:O,activeProtocol:u,doseLoggedToday:m.some(e=>e.date===F&&e.isManual)}})(t,a,r,s,n),[t,a,r,s,n]),b=(0,o.useMemo)(()=>(0,h.F_)(n,d),[n,d]);return(0,u.jsx)(o.Suspense,{fallback:(0,u.jsx)("div",{className:"h-12 bg-black/30 animate-pulse rounded-xl"}),children:(0,u.jsx)(F,{stats:m,doseLoggedToday:g,currentTime:r,onLogDose:i,isLogging:l,medicationName:n,medicationColor:b,activeProtocol:x})})},z=e=>{let{protocols:t,collapsedMedications:a,onToggleMedication:o,onEditProtocol:r,onDeleteClick:n}=e;const{isDarkMode:i}=(0,m.DP)();if(0===t.length)return null;const l=t.reduce((e,t)=>{const a=s.db.find(e=>e.id===t.medication),o=(null===a||void 0===a?void 0:a.name)||t.medication;return e[o]||(e[o]=[]),e[o].push(t),e},{});return(0,u.jsx)("div",{className:"space-y-3 mb-4",children:Object.entries(l).map(e=>{let[t,l]=e;const d=!a.has(t);return(0,u.jsxs)("div",{className:"rounded-lg p-3 border ".concat(i?"bg-black/20 border-[#B19CD9]/20":"bg-gray-50 border-gray-200"),children:[(0,u.jsxs)("button",{onClick:()=>o(t),className:"w-full flex items-center justify-between mb-2",children:[(0,u.jsxs)("div",{className:"text-left",children:[(0,u.jsx)("p",{className:"text-base font-medium ".concat(i?"text-text-primary":"text-gray-900"),children:t}),(0,u.jsx)("p",{className:"text-sm ".concat(i?"text-text-muted":"text-gray-600"),children:(0,s.QR)(l[0].frequencyPerWeek)})]}),(0,u.jsx)("svg",{className:"w-5 h-5 text-text-muted transition-transform ".concat(d?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),d&&(0,u.jsxs)("div",{className:"space-y-1",children:[l.map((e,t)=>(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:"flex items-start justify-between gap-2 py-2",children:[(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsxs)("span",{className:"text-sm font-medium whitespace-nowrap ".concat(i?"text-text-primary":"text-gray-900"),children:[e.dose,"mg"]}),"titrate"===e.phase&&(0,u.jsx)("span",{className:"text-[#4ADEA8]",children:(0,u.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})})]}),(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsxs)("span",{className:"text-sm whitespace-nowrap ".concat(i?"text-text-muted":"text-gray-600"),children:[(0,s.kz)(e.startDate)," \u2192 ",e.stopDate?(0,s.kz)(e.stopDate):"Ongoing"]}),(0,u.jsx)("button",{onClick:()=>r(e),className:"text-sm text-accent-purple-light hover:text-accent-purple-medium",children:"Edit"})]})]}),t<l.length-1&&(0,u.jsx)("div",{className:"border-b ".concat(i?"border-[#B19CD9]/20":"border-gray-200")})]},e.id)),(0,u.jsx)("button",{onClick:()=>n(t),className:"mt-2 px-2 py-1 text-xs border rounded transition-all ".concat(i?"text-red-400 hover:text-red-500 border-red-500/30 hover:bg-red-500/10":"text-red-600 hover:text-red-700 border-red-300 hover:bg-red-50"),children:"Delete"})]})]},t)})})},P=e=>{let{isOpen:t,onClose:a,onAcknowledged:r}=e;const{isDarkMode:s}=(0,m.DP)(),[n,i]=(0,o.useState)(!1);if((0,o.useEffect)(()=>{t&&i(!1)},[t]),!t)return null;return(0,u.jsxs)("div",{className:"fixed inset-0 z-[10001] flex items-center justify-center p-4",style:{animation:"fadeIn 0.2s ease-out"},children:[(0,u.jsx)("div",{className:"fixed inset-0 ".concat(s?"bg-black/60":"bg-black/40"),style:{backdropFilter:"blur(8px)",animation:"fadeIn 0.2s ease-out"},onClick:()=>{a(),i(!1)}}),(0,u.jsxs)("div",{className:"relative rounded-2xl shadow-2xl w-full max-w-sm p-6 ".concat(s?"bg-gradient-to-b from-[#1a1625]/70 to-[#0d0a15]/95 border border-[#B19CD9]/30":"bg-gradient-to-b from-white to-gray-50 border border-gray-200"),style:{animation:"slideUp 0.2s ease-out"},children:[(0,u.jsx)("h2",{className:"text-xl font-semibold mb-4 ".concat(s?"text-white":"text-gray-900"),children:"Disclaimer"}),(0,u.jsx)("p",{className:"text-sm mb-4 leading-relaxed ".concat(s?"text-text-muted":"text-gray-600"),children:"This app is for informational and tracking purposes only. Medication schedules shown are based on publicly available prescribing information and are not medical advice."}),(0,u.jsx)("p",{className:"text-sm mb-6 leading-relaxed ".concat(s?"text-text-muted":"text-gray-600"),children:"By continuing, you confirm that the selected schedule was prescribed by your licensed healthcare provider. This app does not prescribe, recommend, or adjust medication doses. Always consult your healthcare provider before starting, stopping, or changing any medication."}),(0,u.jsxs)("label",{className:"flex items-start gap-3 mb-6 cursor-pointer",children:[(0,u.jsxs)("div",{className:"relative mt-0.5",children:[(0,u.jsx)("input",{type:"checkbox",checked:n,onChange:e=>i(e.target.checked),className:"peer w-5 h-5 appearance-none rounded border transition-all ".concat(s?"border-[#B19CD9]/50 bg-black/30 checked:bg-[#B19CD9] checked:border-[#B19CD9]":"border-gray-300 bg-white checked:bg-[#B19CD9] checked:border-[#B19CD9]")}),(0,u.jsx)("svg",{className:"absolute top-0.5 left-0.5 w-4 h-4 text-white pointer-events-none opacity-0 peer-checked:opacity-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})]}),(0,u.jsx)("span",{className:"text-sm text-[#4ADEA8]",children:"I understand and agree to the above"})]}),(0,u.jsxs)("div",{className:"flex gap-3",children:[(0,u.jsx)("button",{onClick:()=>{a(),i(!1)},className:"flex-1 py-3 rounded-xl border transition-all font-medium ".concat(s?"border-[#B19CD9]/40 text-white/80 hover:text-white hover:bg-white/10":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"}),(0,u.jsx)("button",{onClick:()=>{localStorage.setItem("glpal_disclaimer_acknowledged","true"),r()},disabled:!n,className:"flex-1 py-3 rounded-xl bg-gradient-to-r font-medium transition-all ".concat(n?"from-[#B19CD9] to-[#9C7BD3] text-white hover:shadow-[0_0_20px_rgba(177,156,217,0.5)]":"from-[#B19CD9]/50 to-[#9C7BD3]/50 text-white/50 cursor-not-allowed"),children:"Continue"})]})]})]})},W=e=>{let{isOpen:t,medicationName:a,onClose:o,onConfirm:r}=e;return t?(0,u.jsxs)("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4",style:{animation:"fadeIn 0.2s ease-out"},children:[(0,u.jsx)("div",{className:"fixed inset-0 bg-black/60",style:{backdropFilter:"blur(8px)",animation:"fadeIn 0.2s ease-out"},onClick:o}),(0,u.jsxs)("div",{className:"relative bg-gradient-to-b from-[#1a1625]/70 to-[#0d0a15]/95 rounded-2xl shadow-2xl border border-red-500/30 w-full max-w-sm p-6",style:{animation:"slideUp 0.2s ease-out"},children:[(0,u.jsxs)("h2",{className:"text-xl font-semibold text-white mb-2",children:["Delete ",a,"?"]}),(0,u.jsx)("p",{className:"text-sm text-text-muted mb-6",children:"This will remove all protocols for this medication. This action cannot be undone."}),(0,u.jsxs)("div",{className:"flex gap-3",children:[(0,u.jsx)("button",{onClick:o,className:"flex-1 py-3 rounded-xl border border-[#B19CD9]/40 text-white/80 hover:text-white hover:bg-white/10 transition-all font-medium",children:"Cancel"}),(0,u.jsx)("button",{onClick:r,className:"flex-1 py-3 rounded-xl bg-red-500/80 text-white font-medium hover:bg-red-500 transition-all",children:"Delete"})]})]})]}):null},Y=e=>{let{isOpen:t,onClose:a,onConfirm:o}=e;return t?(0,u.jsxs)("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4",style:{animation:"fadeIn 0.2s ease-out"},children:[(0,u.jsx)("div",{className:"fixed inset-0 bg-black/60",style:{backdropFilter:"blur(8px)",animation:"fadeIn 0.2s ease-out"},onClick:a}),(0,u.jsxs)("div",{className:"relative bg-gradient-to-b from-[#1a1625]/95 to-[#0d0a15]/95 rounded-2xl shadow-2xl border border-red-500/30 w-full max-w-sm p-6",style:{animation:"slideUp 0.2s ease-out"},children:[(0,u.jsx)("h3",{className:"text-lg font-bold text-white mb-3",children:"Disclaimer"}),(0,u.jsx)("p",{className:"text-sm text-gray-300 mb-4",children:"By proceeding, you confirm that you have consulted your healthcare provider regarding any missed doses and understand this app does not provide medical advice."}),(0,u.jsxs)("div",{className:"flex gap-3",children:[(0,u.jsx)("button",{onClick:a,className:"flex-1 py-2 px-4 rounded-lg bg-gray-600 text-white font-semibold text-sm hover:bg-gray-500 transition-all",children:"Cancel"}),(0,u.jsx)("button",{onClick:o,className:"flex-1 py-2 px-4 rounded-lg bg-gradient-to-r from-[#EF4444] to-[#F87171] text-white font-semibold text-sm hover:scale-[1.02] transition-all",style:{boxShadow:"0 0 20px rgba(239,68,68,0.5)"},children:"I Understand, Proceed"})]})]})]}):null},H=e=>{let{isOpen:t,onClose:a,onSave:r,useWheelForDate:n=!0}=e;const{isDarkMode:d}=(0,m.DP)(),[c,x]=(0,o.useState)("semaglutide"),[g,h]=(0,o.useState)(()=>{const e=new Date;return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"))}),[b,p]=(0,o.useState)(!1),[f,y]=(0,o.useState)(!1),[D,v]=(0,o.useState)(!1),[w,j]=(0,o.useState)(!1);if((0,o.useEffect)(()=>{t?(v(!0),j(!1),document.body.classList.add("modal-open")):D&&!w&&(j(!0),setTimeout(()=>{v(!1),j(!1),document.body.classList.remove("modal-open")},200))},[t]),!D)return null;return(0,u.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[(0,u.jsx)("div",{className:"fixed inset-0 bg-black/60 ".concat(w?"backdrop-fade-out":"backdrop-fade-in"),style:{backdropFilter:"blur(8px)"},onClick:a}),(0,u.jsxs)("div",{className:"relative rounded-2xl shadow-2xl border border-[#B19CD9]/30 w-full max-w-sm p-6 ".concat(d?"bg-gradient-to-b from-[#1a1625]/70 to-[#0d0a15]/95":"bg-white/95"," ").concat(w?"modal-fade-out":"modal-fade-in"),children:[(0,u.jsx)("h2",{className:"text-xl font-semibold mb-6 ".concat(d?"text-white":"text-gray-900"),children:"Add Schedule"}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 mb-3"}),(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium mb-2 ".concat(d?"text-white":"text-gray-700"),children:"Medication"}),(0,u.jsx)("div",{className:"grid grid-cols-1 gap-2",children:s.db.filter(e=>e.titrationDoses&&e.titrationDoses.length>0&&["semaglutide","tirzepatide","retatrutide","cagrilintide"].includes(e.id)).map(e=>(0,u.jsx)("button",{type:"button",onClick:()=>x(e.id),className:"text-left px-3 py-2 rounded-lg transition-all text-sm ".concat(c===e.id?"bg-[#B19CD9]/30 border border-[#B19CD9]":d?"bg-black/20 border border-transparent hover:bg-[#B19CD9]/10":"bg-gray-100 border border-transparent hover:bg-gray-200"),children:(0,u.jsx)("span",{className:"".concat(d?"text-text-primary":"text-gray-900"),children:e.name})},e.id))})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-4"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium mb-2 ".concat(d?"text-white":"text-gray-700"),children:"Split Dosing"}),(0,u.jsxs)("div",{className:"flex gap-2",children:[(0,u.jsx)("button",{type:"button",onClick:()=>p(!1),className:"flex-1 py-2 rounded-lg text-sm font-medium transition-all ".concat(b?d?"bg-black/20 text-[#B19CD9] border border-[#B19CD9]/30":"bg-gray-200 text-gray-700 border border-gray-300":"bg-gradient-to-r from-[#B19CD9] to-[#9C7BD3] text-white"),children:"No"}),(0,u.jsx)("button",{type:"button",onClick:()=>p(!0),className:"flex-1 py-2 rounded-lg text-sm font-medium transition-all ".concat(b?"bg-gradient-to-r from-[#B19CD9] to-[#9C7BD3] text-white":d?"bg-black/20 text-[#B19CD9] border border-[#B19CD9]/30":"bg-gray-200 text-gray-700 border border-gray-300"),children:"Yes"})]}),b&&(0,u.jsx)("p",{className:"text-xs text-[#4ADEA8] mt-1",children:"Dose will be split in half and taken every 3.5 days"})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-4"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium mb-2 ".concat(d?"text-white":"text-gray-700"),children:"Start Date"}),(0,u.jsx)("button",{type:"button",onClick:()=>y(!0),className:"w-full px-3 py-2 border rounded-lg text-sm text-left ".concat(d?"border-[#B19CD9]/30 bg-black/20 text-[#B19CD9]":"border-gray-300 bg-white text-gray-700"),children:new Date(g).toLocaleDateString()})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-4"}),(0,u.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,u.jsx)("button",{onClick:a,className:"flex-1 py-3 rounded-xl border transition-all font-medium ".concat(d?"border-[#B19CD9]/40 text-white/80 hover:text-white hover:bg-white/10":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"}),(0,u.jsx)("button",{onClick:()=>{const e=s.db.find(e=>e.id===c);if(null===e||void 0===e||!e.titrationDoses||0===e.titrationDoses.length)return;const t=e.titrationDoses,o=b?2:1,n=t.map((t,a)=>{const r=new Date(new Date(g).getTime()+28*a*24*60*60*1e3),n=new Date(new Date(g).getTime()+28*(a+1)*24*60*60*1e3-1);return{id:(0,s.$C)(),medication:e.name,dose:b?t/2:t,frequencyPerWeek:o,startDate:r.toISOString().split("T")[0],stopDate:n.toISOString().split("T")[0],halfLifeHours:e.halfLifeHours,phase:"titrate"}});r(n),a()},className:"flex-1 py-3 rounded-xl bg-gradient-to-r from-[#B19CD9] to-[#9C7BD3] text-white font-medium hover:shadow-[0_0_20px_rgba(177,156,217,0.5)] transition-all",children:"Create"})]})]})]}),f&&(n?(0,u.jsx)(i.A,{isOpen:f,value:g,onChange:e=>{h(e),y(!1)},onClose:()=>y(!1)}):(0,u.jsx)(l.A,{isOpen:f,value:g,onChange:e=>{h(e),y(!1)},onClose:()=>y(!1)}))]})};var U=a(6855),R=a(1285);const q=e=>{const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(o)},J=e=>{const[t,a,o]=e.split("-").map(Number);return new Date(t,a-1,o).getTime()},V=(e,t,a,r,s)=>(0,o.useMemo)(()=>{const o=new Date(a),n=(new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0),q(o)),i=s?null===t||void 0===t?void 0:t.filter(e=>e.medication===s&&!e.isArchived):null===t||void 0===t?void 0:t.filter(e=>!e.isArchived),l=s?e.filter(e=>e.medication===s):e,d=null===i||void 0===i?void 0:i.find(e=>{const t=e.startDate,a=e.stopDate||"2099-12-31";return n>=t&&n<=a});let c=7;d&&(c=Math.round(7/d.frequencyPerWeek));[...l].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime());let m=null,u=0,x=0,g=0,h=0,b=0,p="N/A",f=null;const y=(null===d||void 0===d?void 0:d.startDate)||"",D=o.getTime();if(d&&y){const e=J(y),t=J(n),a=24*c*60*60*1e3,r=Math.floor((t-e)/864e5),s=e+(Math.floor(r/c)+(0===r%c?0:1))*a,i=s-a;m=new Date(i),f=new Date(s),b=(o.getTime()-i)/864e5;const l=s-D;u=Math.floor(l/864e5),x=Math.floor(l%864e5/36e5),g=Math.floor(l%36e5/6e4),h=Math.floor(l%6e4/1e3),p=f.toLocaleDateString("en-US",{month:"short",day:"numeric"})}const v=m,w=v?v.toLocaleDateString("en-US",{month:"short",day:"numeric"}):"N/A";if(!d&&v){b=(o.getTime()-v.getTime())/864e5,f=new Date(v.getTime()+24*c*60*60*1e3),p=f.toLocaleDateString("en-US",{month:"short",day:"numeric"});const e=f.getTime()-o.getTime();u=Math.floor(e/864e5),x=Math.floor(e%864e5/36e5),g=Math.floor(e%36e5/6e4),h=Math.floor(e%6e4/1e3),e<0&&0===u&&(x=Math.ceil(e/36e5),x<0&&(u=-1,x=24+x))}const j=l.length,S=l.length>0?l[0].dose:0,C=l.filter(e=>{const t=new Date(e.date);return t.getMonth()===o.getMonth()&&t.getFullYear()===o.getFullYear()}).length,N=(()=>{if(!i||0===i.length)return 0;const e=new Date(o);e.setMonth(e.getMonth()+1);let t=0;return i.forEach(a=>{const r=new Date(a.startDate),s=a.stopDate?new Date(a.stopDate):e,n=7/a.frequencyPerWeek;let i=new Date(r);for(;i<=s&&i<=e;)i>o&&t++,i=new Date(i.getTime()+24*n*60*60*1e3)}),t})(),k=!(!d||d.startDate!==n),M=(f?q(f):null)===n,B=((e,t)=>{const a={semaglutide:{isOverdue:!1,daysSinceLastDose:0,entryToday:!1},tirzepatide:{isOverdue:!1,daysSinceLastDose:0,entryToday:!1},retatrutide:{isOverdue:!1,daysSinceLastDose:0,entryToday:!1},cagrilintide:{isOverdue:!1,daysSinceLastDose:0,entryToday:!1}},o=q(t),r=new Date(t.getFullYear(),t.getMonth(),t.getDate());for(const s of E){const t=e.filter(e=>I(e.medication)===s&&e.isManual);if(0===t.length){a[s]={isOverdue:!1,daysSinceLastDose:0,entryToday:!1};continue}const n=[...t].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())[0];if(!n)continue;const[i,l,d]=n.date.split("-").map(Number),c=new Date(i,l-1,d),m=Math.floor((r.getTime()-c.getTime())/864e5);a[s]={isOverdue:m>=8,daysSinceLastDose:m,entryToday:t.some(e=>e.date===o)}}return a})(e,o);return{totalDoses:j,currentDoses:[],totalCurrentDose:S,nextDueDays:u,nextDueHours:x,nextDueMinutes:g,nextDueSeconds:h,nextDueDateStr:p,currentLevel:0,thisMonth:C,plannedDoses:N,lastDoseDateStr:w,daysSinceLastDose:b,intervalDays:c,isScheduleStartDay:k,isDueToday:M,latestDoseDone:r,isOverdue:(()=>{if(0===l.length)return!1;const e=[...l].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())[0];if(!e)return!1;const t=new Date(e.date),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(o.getFullYear(),o.getMonth(),o.getDate());return Math.floor((r.getTime()-a.getTime())/864e5)>=8})(),actualDaysSinceLastDose:(()=>{if(0===l.length)return 0;const e=[...l].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())[0];if(!e)return 0;const t=new Date(e.date),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(o.getFullYear(),o.getMonth(),o.getDate());return Math.floor((r.getTime()-a.getTime())/864e5)})(),semaglutideIsOverdue:B.semaglutide.isOverdue,tirzepatideIsOverdue:B.tirzepatide.isOverdue,retatrutideIsOverdue:B.retatrutide.isOverdue,cagrilintideIsOverdue:B.cagrilintide.isOverdue,semaglutideEntryToday:B.semaglutide.entryToday,tirzepatideEntryToday:B.tirzepatide.entryToday,retatrutideEntryToday:B.retatrutide.entryToday,cagrilintideEntryToday:B.cagrilintide.entryToday,semaglutideDaysSinceLastDose:B.semaglutide.daysSinceLastDose,tirzepatideDaysSinceLastDose:B.tirzepatide.daysSinceLastDose,retatrutideDaysSinceLastDose:B.retatrutide.daysSinceLastDose,cagrilintideDaysSinceLastDose:B.cagrilintide.daysSinceLastDose}},[e,t,a,r,s]);const G=e=>{let{medicationEntries:t,onAddMedication:a,onRefreshMedications:i,onLogDose:l,chartPeriod:d,onChartPeriodChange:x,useWheelForNumbers:h=!0,useWheelForDate:b=!0}=e;const[p,f]=(0,o.useState)(!1),[y,w]=(0,o.useState)(!1),[j,S]=(0,o.useState)(!1),[C,N]=(0,o.useState)(null),[k,M]=(0,o.useState)(()=>(0,R.O3)()),[T,L]=(0,o.useState)(null),[O,E]=(0,o.useState)(!1),[F,q]=(0,o.useState)("add"),[J,G]=(0,o.useState)(!1),[Z,$]=(0,o.useState)(!1),[K,Q]=(0,o.useState)(null),[X,ee]=(0,o.useState)(()=>{const e=localStorage.getItem("glpal_collapsed_medications");return e?new Set(JSON.parse(e)):new Set});(0,o.useEffect)(()=>{localStorage.setItem("glpal_collapsed_medications",JSON.stringify(Array.from(X)))},[X]);const[te,ae]=(0,o.useState)(!1),[oe,re]=(0,o.useState)(!1),[se,ne]=(0,o.useState)(""),[ie,le]=(0,o.useState)(()=>{const e=localStorage.getItem("latestDoseDone");return e?parseInt(e,10):null}),de=(0,U.z5)(100),ce=new Date(de),me=(e=>(0,o.useMemo)(()=>{const t=c.P.todayString();return null===e||void 0===e?void 0:e.find(e=>{if(e.isArchived)return!1;const a=e.startDate,o=e.stopDate||"2099-12-31";return t>=a&&t<=o})},[e]))(k),ue=V(t,k,ce,ie),xe=(0,o.useMemo)(()=>{const e=new Set;return k.forEach(t=>{t.isArchived||e.add(t.medication)}),Array.from(e)},[k]),{bigCard:ge,bigCardText:he,smallCard:be,text:pe}=(0,m.$E)(),fe=(0,o.useMemo)(()=>t.filter(e=>!e.isManual),[t]);(0,o.useEffect)(()=>{const e=localStorage.getItem("latestDoseDone");e&&le(parseInt(e,10))},[]);const ye=e=>{(0,n.n4)();(0,R.rb)(e,[]).forEach(e=>(0,n.Ko)(e));const t=new Date;t.setHours(0,0,0,0),e.forEach(e=>{if(e.isArchived)return;const a=new Date(e.startDate),o=e.stopDate?new Date(e.stopDate):t,r=7/e.frequencyPerWeek;let s=new Date(a);for(;s<o&&s<=t;){const t=s.toISOString().split("T")[0];if(!(0,n.Sr)().some(a=>a.date===t&&a.medication===e.medication)){const a={date:t,medication:e.medication,dose:e.dose,halfLifeHours:e.halfLifeHours,isManual:!0};(0,n.D4)(a)}s=new Date(s.getTime()+24*r*60*60*1e3)}})},De=e=>k.find(t=>{if(t.isArchived||t.medication!==e)return!1;const a=t.startDate,o=t.stopDate||"2099-12-31",r=c.P.todayString();return r>=a&&r<=o}),ve=e=>{const a=e||(null===me||void 0===me?void 0:me.medication),o=a?De(a):me,r=!!a&&((e,t,a)=>{const o=I(t);if(!o)return!1;const r=e.filter(e=>I(e.medication)===o&&e.isManual);if(0===r.length)return!1;const s=[...r].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())[0];if(!s)return!1;const[n,i,l]=s.date.split("-").map(Number),d=new Date(n,i-1,l),c=new Date(a.getFullYear(),a.getMonth(),a.getDate());return Math.floor((c.getTime()-d.getTime())/864e5)>=8})(t,a,ce);if(r)return ne(a||""),void re(!0);const s=c.P.nowDate();"".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0"),"-").concat(String(s.getDate()).padStart(2,"0"));o?(S(!0),N(o),w(!0)):f(!0)};(0,o.useEffect)(()=>{const e=c.P.todayString(),t=localStorage.getItem("lastLoggedDate")!==e,a=localStorage.getItem("lastLoggedProtocolId")!==((null===me||void 0===me?void 0:me.id)||"");t&&localStorage.setItem("lastLoggedDate",e),a&&me&&localStorage.setItem("lastLoggedProtocolId",me.id)},[ce,null===me||void 0===me?void 0:me.id,t]);return(0,u.jsxs)("div",{className:"space-y-3",children:[(0,u.jsxs)("div",{className:ge,children:[(0,u.jsx)("h1",{className:he.title,style:{textShadow:"0 0 15px var(--accent-purple-light-shadow)"},children:"Doses"}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 mb-3"}),(0,u.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,u.jsxs)("div",{className:"grid grid-cols-3 gap-2 sm:gap-3 overflow-visible",children:[(0,u.jsxs)("div",{className:be,children:[(0,u.jsx)("p",{className:pe.label,children:"Total Doses"}),(0,u.jsx)("p",{className:pe.value,children:ue.totalDoses})]}),(0,u.jsxs)("div",{className:be,children:[(0,u.jsx)("p",{className:pe.label,children:"Next Due"}),(0,u.jsxs)("p",{className:pe.totalLossValue,style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,u.jsx)("span",{style:{display:"inline-block",whiteSpace:"nowrap"},children:ue.nextDueDays>0?"".concat(ue.nextDueDays," Day").concat(ue.nextDueDays>1?"s":""):"Today"}),(0,u.jsx)("span",{className:pe.percentage,children:ue.nextDueDateStr})]})]}),(0,u.jsxs)("div",{className:be,children:[(0,u.jsx)("p",{className:pe.label,children:"Current Dose"}),(0,u.jsxs)("p",{className:pe.value,children:[ue.totalCurrentDose.toFixed(2),"mg"]})]}),(0,u.jsxs)("div",{className:be,children:[(0,u.jsx)("p",{className:pe.label,children:"Current Level"}),(0,u.jsxs)("p",{className:pe.value,children:[ue.currentLevel.toFixed(2),"mg"]})]}),(0,u.jsxs)("div",{className:be,children:[(0,u.jsx)("p",{className:pe.label,children:"Planned Doses"}),(0,u.jsx)("p",{className:pe.value,children:ue.plannedDoses})]}),(0,u.jsxs)("div",{className:be,children:[(0,u.jsx)("p",{className:pe.label,children:"Logged Doses"}),(0,u.jsx)("p",{className:pe.value,children:ue.thisMonth})]})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-3"}),xe.map((e,a)=>(0,u.jsxs)("div",{children:[a>0&&(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-3"}),(0,u.jsx)(_,{medicationEntries:t,protocols:k,currentTime:ce,latestDoseDone:ie,medicationName:e,onLogDose:()=>ve(e),isLogging:j,allMedications:xe})]},e)),!1,!1,(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-3"}),(0,u.jsxs)("div",{children:[(0,u.jsx)(v.A,{value:d,onChange:x}),(0,u.jsx)("div",{className:"h-64 sm:h-80",children:(0,u.jsx)(r.A,{data:fe,period:d})})]})]}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-3"}),(0,u.jsx)(A,{onClick:()=>f(!0),fullWidth:!0,children:"+ Log Dose Manually"})]}),(0,u.jsxs)("div",{className:ge,children:[(0,u.jsx)("h1",{className:he.title,style:{textShadow:"0 0 15px var(--accent-purple-light-shadow)"},children:"Dosing Plans"}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 mb-3"}),(0,u.jsx)(z,{protocols:k,collapsedMedications:X,onToggleMedication:e=>{ee(t=>{const a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},onEditProtocol:e=>{L(e),q("edit"),E(!0)},onDeleteClick:Q}),(0,u.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-3"}),(0,u.jsxs)("div",{className:"flex gap-2",children:[(0,u.jsx)(A,{onClick:()=>{q("add"),L(null),E(!0)},fullWidth:!0,variant:"accent",children:"+ Custom Plan"}),(0,u.jsx)(A,{onClick:()=>{"true"===localStorage.getItem("glpal_disclaimer_acknowledged")?G(!0):$(!0)},fullWidth:!0,variant:"accent",children:"+ Schedule"})]})]}),(0,u.jsx)(B,{isOpen:O,onClose:()=>E(!1),onSave:e=>{const t=(0,R.sl)(e,k);M(t),ye(t),i()},onArchive:e=>{const t=(0,R.pO)(e,k);M(t),L(null),i()},onDelete:e=>{const t=(0,R.M8)(e,k);M(t),L(null),i()},protocol:T,mode:F,existingProtocols:k,useWheelForNumbers:h,useWheelForDate:b}),(0,u.jsx)(H,{isOpen:J,onClose:()=>G(!1),onSave:e=>{const t=[...k,...e];(0,n.gL)(t),M(t),ye(t),i(),G(!1)},useWheelForDate:b}),(0,u.jsx)(g,{isOpen:p,onClose:()=>f(!1),onAddMedication:a,useWheelForDate:b}),(0,u.jsx)(D,{isOpen:y,onClose:()=>{w(!1),S(!1)},onSave:()=>{const e=c.P.nowDate();le(e.getTime()),localStorage.setItem("latestDoseDone",e.getTime().toString()),i(),l(),S(!1)},protocol:C||me||null,allMedications:xe}),(0,u.jsx)(Y,{isOpen:oe,onClose:()=>re(!1),onConfirm:()=>{re(!1);const e=c.P.nowDate(),t=("".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0")),se||(null===me||void 0===me?void 0:me.medication)),a=t?De(t):me;a?(S(!0),N(a),w(!0)):f(!0)}}),(0,u.jsx)(W,{isOpen:!!K,medicationName:K||"",onClose:()=>Q(null),onConfirm:()=>K&&(e=>{let t=[...k];k.forEach(a=>{const o=s.db.find(e=>e.id===a.medication);((null===o||void 0===o?void 0:o.name)||a.medication)===e&&((0,n.Je)(a.id),t=t.filter(e=>e.id!==a.id))}),(0,n.gL)(t),M(t),ye(t),i(),ee(t=>{const a=new Set(t);return a.delete(e),a}),Q(null)})(K)}),(0,u.jsx)(P,{isOpen:Z,onClose:()=>$(!1),onAcknowledged:()=>{$(!1),G(!0)}})]})}},9396(e,t,a){a.d(t,{A:()=>h});var o=a(2555),r=a(5043),s=a(3490),n=a(7638),i=a(4231),l=a(7012),d=a(8171);var c=a(3547),m=a(6855),u=a(7647),x=a(579);const g=e=>e.replace(/\s*\(.*?\)/g,"").trim(),h=e=>{let{data:t,period:a,onLegendChange:h}=e;const b=(0,r.useRef)(null),{medications:p,medicationColors:f,dosesByMed:y,halfLifeByMed:D}=(0,n.B)(t),v=(0,m.z5)(1e3),w=new Date(v),j=(0,r.useMemo)(()=>t.length>0?new Date(Math.min(...t.map(e=>new Date(e.date).getTime()))):new Date,[t]),S=(0,r.useMemo)(()=>t.length>0?new Date(Math.max(...t.map(e=>new Date(e.date).getTime()))):new Date,[t]),C=(0,r.useMemo)(()=>new Date(S.getTime()+5184e6),[S]),{xAxisDates:N,todayIndex:k,zoomStart:M,zoomEnd:B,visibleStartIndex:T,visibleEndIndex:L}=(0,i.l)(j,C,a,14,w),A=(0,r.useMemo)(()=>{if(0===t.length)return{};const e=(e=>{let{medications:t,medicationColors:a,dosesByMed:r,halfLifeByMed:s,firstDate:n,lastDate:i,xAxisDates:c,todayIndex:m,visibleStartIndex:u,visibleEndIndex:x}=e;const g={},h={},b=new Set,p={};t.forEach(e=>{g[e]=new Set,h[e]={},r[e].forEach(t=>{const a=new Date(t.date.getTime()+864e5).toLocaleDateString("en-US",{month:"short",day:"numeric"});g[e].add(a),h[e][a]=t.dose,b.add(a),p[a]=(p[a]||0)+t.dose})});const f=d.OK.combined,y=[],D=[],v=[],w=[],j=(Array.from(b),new Date(n));for(;j<=i;){let e=0;t.forEach(t=>{e+=(0,l.Rg)(r[t],s[t],new Date(j))});const a=j.toLocaleDateString("en-US",{month:"short",day:"numeric"}),o=b.has(a)?p[a]:void 0,n=isNaN(e)?null:e,i=c.indexOf(a);i<=m&&D.push([a,n]),i>=m&&v.push([a,n]),o&&w.push({name:a,value:[a,n],symbol:"circle",symbolSize:10,itemStyle:{color:f.stroke,borderColor:"#2D1B4E",borderWidth:2,shadowBlur:8,shadowColor:f.stroke+"99"}}),j.setDate(j.getDate()+1)}t.length>0&&y.push({name:"Combined",type:"line",smooth:!0,showSymbol:!1,symbol:"none",itemStyle:{color:f.stroke},lineStyle:{width:2,color:f.stroke},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:f.fill},{offset:1,color:f.fill.replace("0.3","0.02")}]}},emphasis:{lineStyle:{width:3},itemStyle:{opacity:0}},triggerLineEvent:!1,data:D},{name:"Combined_future",type:"line",smooth:!0,showSymbol:!1,symbol:"none",showInLegend:!1,lineStyle:{width:2,color:f.stroke,type:"dotted"},emphasis:{disabled:!0},triggerLineEvent:!1,data:v},{name:"Combined",type:"scatter",z:10,showInLegend:!1,emphasis:{scale:1.2},data:w}),y.forEach(e=>{if("scatter"===e.type&&e.data&&e.data.length>0){let t=null;e.data=e.data.map(e=>{const a=e.value[1];let r=!0;if(null!==t&&t>0&&Math.abs(a-t)/t<=.25&&(r=!1),r){t=a;const r=a<1?a.toFixed(2):a.toFixed(1);return(0,o.A)((0,o.A)({},e),{},{label:{show:!0,position:"top",formatter:r+"mg",color:"#E2E8F0",fontSize:10,distance:8,backgroundColor:"rgba(0, 0, 0, 0.8)",borderRadius:4,borderColor:"rgba(0,0,0,0.4)",borderWidth:1,padding:[2,2],textShadowColor:"rgba(0,0,0,0.8)",textShadowBlur:4,textShadowOffsetX:1,textShadowOffsetY:1}})}return(0,o.A)((0,o.A)({},e),{},{label:{show:!1}})})}}),y.forEach(e=>{if("scatter"===e.type&&e.data&&e.data.length>0){const t=e.data.filter(e=>{const t=c.indexOf(e.value[0]);return t>=u&&t<=x});if(t.length>6){const a=Math.floor(t.length/6);e.data=t.filter((e,t)=>t%a===0).slice(0,6)}}});const S=t.map(e=>{const t=[],o=[],d=[],u=a[e],x=new Date(n);for(;x<=i;){const a=(0,l.Rg)(r[e],s[e],new Date(x)),n=x.toLocaleDateString("en-US",{month:"short",day:"numeric"}),i=g[e].has(n)?h[e][n]:void 0,b=isNaN(a)?null:a,p=c.indexOf(n);p<=m&&t.push([n,b]),p>=m&&o.push([n,b]),i&&d.push({name:n,value:[n,b],symbol:"circle",symbolSize:10,itemStyle:{color:u.stroke,borderColor:"#2D1B4E",borderWidth:2,shadowBlur:8,shadowColor:u.stroke+"99"}}),x.setDate(x.getDate()+1)}return[{name:e,type:"line",smooth:!0,showSymbol:!1,symbol:"none",itemStyle:{color:u.stroke},lineStyle:{width:2,color:u.stroke},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:u.fill},{offset:1,color:u.fill.replace("0.3","0.02")}]}},emphasis:{lineStyle:{width:3},itemStyle:{opacity:0}},triggerLineEvent:!1,data:t},{name:e+"_future",type:"line",smooth:!0,showSymbol:!1,symbol:"none",showInLegend:!1,lineStyle:{width:2,color:u.stroke,type:"dotted"},emphasis:{disabled:!0},triggerLineEvent:!1,data:o},{name:e,type:"scatter",z:10,showInLegend:!1,emphasis:{scale:1.2},data:d}]}).flat();if(S.forEach(e=>{if("scatter"===e.type&&e.data&&e.data.length>0){let t=null;e.data=e.data.map(e=>{const a=e.value[1];let r=!0;if(null!==t&&t>0&&Math.abs(a-t)/t<=.25&&(r=!1),r){t=a;const r=a<1?a.toFixed(2):a.toFixed(1);return(0,o.A)((0,o.A)({},e),{},{label:{show:!0,position:"top",formatter:r+"mg",color:"#E2E8F0",fontSize:10,distance:8,backgroundColor:"rgba(0, 0, 0, 0.8)",borderRadius:4,borderColor:"rgba(0,0,0,0.4)",borderWidth:1,padding:[2,2],textShadowColor:"rgba(0,0,0,0.8)",textShadowBlur:4,textShadowOffsetX:1,textShadowOffsetY:1}})}return(0,o.A)((0,o.A)({},e),{},{label:{show:!1}})})}}),S.forEach(e=>{if("scatter"===e.type&&e.data&&e.data.length>0){const t=e.data.filter(e=>{const t=c.indexOf(e.value[0]);return t>=u&&t<=x});if(t.length>6){const a=Math.floor(t.length/6);e.data=t.filter((e,t)=>t%a===0).slice(0,6)}}}),m>=0){const e={silent:!0,symbol:"none",z:100,label:{show:!1},lineStyle:{type:"dotted",width:2,color:"#94A3B8"},data:[{xAxis:c[m]}]},a={name:"Today",type:"line",markLine:e,data:[],silent:!0,animation:!1,lineStyle:{opacity:0},areaStyle:{opacity:0}};return y.length>0&&(y[2].markLine=e),S.length>0&&(S[2].markLine=e),[...t.length>1?y:[],...S,a]}return[...t.length>1?y:[],...S]})({medications:p,medicationColors:f,dosesByMed:y,halfLifeByMed:D,firstDate:j,lastDate:C,xAxisDates:N,todayIndex:k,visibleStartIndex:T,visibleEndIndex:L});return{backgroundColor:"transparent",animation:!(0,u.Fr)(),tooltip:{trigger:"axis",backgroundColor:"rgba(20, 15, 35, 0.95)",borderColor:"rgba(177, 156, 217, 0.4)",borderWidth:1,borderRadius:12,padding:[12,16],extraCssText:"box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4); backdrop-filter: blur(10px);",textStyle:{color:"#E2E8F0",fontSize:13},formatter:e=>{if(!e||!e.length)return"";const t=e.filter(e=>"scatter"!==e.seriesType).map(e=>{var t;return(0,o.A)((0,o.A)({},e),{},{seriesName:(null===(t=e.seriesName)||void 0===t?void 0:t.replace("_future",""))||e.seriesName})}),a=[],r=new Set;for(const o of t)r.has(o.seriesName)||(r.add(o.seriesName),a.push(o));const s=a.filter(e=>{var t,a;return(null!==(t=null===(a=e.value)||void 0===a?void 0:a[1])&&void 0!==t?t:0)>0}),n=e[0].axisValue,i=N.indexOf(n),l=i>=0?new Date(j.getTime()+24*i*60*60*1e3):new Date,d="".concat(n," ").concat(l.getFullYear());if(0===s.length)return"".concat(d,'<div style="color: #94a3b8; font-size: 11px;">No active dose</div>');let c='<div style="font-weight: 600; margin-bottom: 8px; padding-bottom: 6px; border-bottom: 1px solid rgba(156, 123, 211, 0.2);">'.concat(d,"</div>");return s.forEach(e=>{var t,a;const o=e.color||"#9C7BD3",r=null!==(t=null===(a=e.value)||void 0===a?void 0:a[1])&&void 0!==t?t:0,s=r<1?r.toFixed(2):r.toFixed(1),n=g(e.seriesName);c+='<div style="display: flex; align-items: center; gap: 10px; margin: 4px 0;">\n              <span style="width: 10px; height: 10px; border-radius: 50%; background: '.concat(o,"; box-shadow: 0 0 6px ").concat(o,'80;"></span>\n              <span style="color: #94a3b8;">').concat(n,':</span>\n              <span style="font-weight: 600; color: #fff;">').concat(s," mg</span>\n            </div>")}),c}},legend:{data:p.length>1?["Combined",...p]:p,bottom:0,icon:"circle",itemWidth:12,itemHeight:12,textStyle:{fontSize:12,color:"#94a3b8"},formatter:e=>g(e),tooltip:{trigger:"item"}},dataZoom:[{type:"inside",start:M,end:B,zoomOnMouseWheel:!0,moveOnMouseWheel:!0}],grid:{top:0,left:10,right:10,bottom:25,containLabel:!0},xAxis:{type:"category",data:N,boundaryGap:!1,axisLine:{lineStyle:{color:"rgba(156, 123, 211, 0.2)"}},axisTick:{lineStyle:{color:"rgba(156, 123, 211, 0.2)"}},axisLabel:{fontSize:12,color:"#94a3b8"},splitLine:{show:!1}},yAxis:{type:"value",position:"right",min:0,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#94a3b8",fontSize:11,margin:10,formatter:e=>e.toFixed(1)+"mg"},splitLine:{lineStyle:{color:"rgba(156, 123, 211, 0.1)",type:"dashed"}}},series:e}},[t,p,f,y,D,j,S,N,k,M,B,T,L]);return 0===t.length?(0,x.jsx)(c.A,{title:"No dose data yet",description:"Log your first dose to see the chart"}):(0,x.jsx)("div",{className:"w-full h-full relative",children:(0,x.jsx)(s.A,{ref:b,option:A,style:{height:"100%",width:"100%",opacity:1},opts:{renderer:"svg"},onEvents:{legendselectchanged:e=>{var t;const{selected:a,name:o}=e,r=null===(t=b.current)||void 0===t?void 0:t.getEchartsInstance();if(!r)return;const s=a[o];"Combined"===o&&r.dispatchAction({type:s?"legendSelect":"legendUnSelect",name:"Combined_future"}),p.forEach(e=>{o===e&&r.dispatchAction({type:s?"legendSelect":"legendUnSelect",name:e+"_future"})})}}})})}},7596(e,t,a){a.d(t,{A:()=>f});var o=a(5043),r=a(7950),s=a(4749),n=a(1208),i=a(2885),l=a(8421),d=a(4912),c=a(3695),m=a(9950),u=a(3031),x=a(6465),g=a(7142),h=a(5757),b=a(579);const p=e=>{let{selected:t,onSelect:a,month:r,isDarkMode:n=!1,onTodayClick:l}=e;const p=Array.from({length:13},(e,t)=>(0,i.P)(r,t-6)),f=(0,o.useRef)(null),y=(0,o.useRef)(!0);(0,o.useEffect)(()=>{if(f.current&&y.current){const e=f.current,t=6;setTimeout(()=>{const a=e.children[t];a&&a.scrollIntoView({behavior:"auto",block:"center"}),y.current=!1},100)}},[]);const D=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],v=n?"#ffffff":"#374151",w=n?"rgba(255, 255, 255, 0.25)":"rgba(0, 0, 0, 0.15)",j=n?"#9CA3AF":"#6B7280",S=n?"#B19CD9":"#9C7BD3",C="#4ADEA8",N=(e,o)=>{const n=(e=>{const t=(0,d.w)(e),a=(0,c.p)(e);return(0,m.k)({start:t,end:a})})(e),i=(0,u.P)((0,d.w)(e)),l=(0,s.GP)(e,"MMMM yyyy");return(0,b.jsxs)("div",{className:"mb-4 last:mb-0",children:[(0,b.jsx)("div",{className:"text-center text-sm font-semibold mb-2",style:{color:j},children:l}),(0,b.jsx)("div",{className:"grid grid-cols-7 mb-2",children:D.map(e=>(0,b.jsx)("div",{className:"text-center text-xs font-medium uppercase",style:{color:j},children:e},e))}),(0,b.jsxs)("div",{className:"grid grid-cols-7 gap-1",children:[Array.from({length:i}).map((e,t)=>(0,b.jsx)("div",{className:"aspect-square"},"empty-".concat(t))),n.map(e=>{const o=t&&(0,x.r)(e,t),n=(0,g.c)(e),i=(0,h.t)(e,r);return(0,b.jsx)("button",{type:"button",onClick:()=>(e=>{a(e)})(e),className:"aspect-square rounded-lg flex items-center justify-center text-sm transition-all",style:{color:i?o?"#ffffff":v:w,backgroundColor:o?S:"transparent",fontWeight:n&&!o?"600":"400",border:n&&!o?"2px solid ".concat(C):"none"},children:(0,s.GP)(e,"d")},e.toISOString())})]})]},e.toISOString())};return(0,b.jsxs)("div",{className:"w-full",children:[l&&(0,b.jsx)("div",{className:"flex justify-center mb-3",children:(0,b.jsx)("button",{type:"button",onClick:()=>l?l(new Date):void 0,className:"text-xs font-medium px-3 py-1 rounded-full transition-colors",style:{backgroundColor:n?"rgba(74, 222, 168, 0.2)":"rgba(74, 222, 168, 0.15)",color:C},children:"Today"})}),(0,b.jsx)("div",{ref:f,className:"overflow-y-auto max-h-[500px] pr-1",children:p.map((e,t)=>N(e))})]})},f=e=>{let{isOpen:t,value:a,onChange:d,onClose:c}=e;const{isDarkMode:m}=(0,l.DP)(),[u,x]=(0,o.useState)(a?new Date(a):void 0),g=()=>{if(a){const e=new Date(a);return new Date(e.getFullYear(),e.getMonth(),1)}const e=new Date;return new Date(e.getFullYear(),e.getMonth(),1)},[h,f]=(0,o.useState)(g()),[y,D]=(0,o.useState)(!1),[v,w]=(0,o.useState)(!1),j=(new Date).getFullYear(),S=Array.from({length:20},(e,t)=>j-10+t);(0,o.useEffect)(()=>{t&&(D(!0),w(!1),x(a?new Date(a):void 0),f(g()))},[t,a]);const C=()=>{if(v)return;w(!0);const e=setTimeout(()=>{D(!1),w(!1),c()},200);return()=>clearTimeout(e)};if(!y)return null;const N=(0,b.jsxs)("div",{className:"fixed inset-0 z-[99999] flex items-center justify-center p-4",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/60 ".concat(v?"backdrop-fade-out":"backdrop-fade-in"),style:{backdropFilter:"blur(8px)"},onClick:C}),(0,b.jsx)("div",{className:"relative w-full max-w-sm",children:(0,b.jsxs)("div",{className:"relative isolate rounded-2xl border shadow-2xl p-4 max-h-[90vh] overflow-y-auto transition-all ".concat(m?"border-[#B19CD9]/30 bg-gradient-to-b from-[#1a1625]/95 to-[#0d0a15]/95":"border-gray-200 bg-white"," ").concat(v?"modal-fade-out":"modal-content-fade-in"),style:m?{boxShadow:"0 0 30px rgba(177, 156, 217, 0.3)"}:{},children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold ".concat(m?"text-white":"text-gray-900"),children:"Select Date"}),(0,b.jsx)("button",{onClick:C,className:"p-1 rounded-lg transition-colors ".concat(m?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{f((0,n.a)(h,1))},className:"p-2 rounded-lg transition-colors ".concat(m?"text-[#B19CD9] hover:bg-[#B19CD9]/20":"text-[#9C7BD3] hover:bg-[#9C7BD3]/10"),children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("select",{value:h.getMonth(),onChange:e=>{const t=parseInt(e.target.value);f(new Date(h.getFullYear(),t,1))},className:"text-sm font-semibold bg-transparent border-none cursor-pointer focus:outline-none ".concat(m?"text-white":"text-gray-900"),children:["January","February","March","April","May","June","July","August","September","October","November","December"].map((e,t)=>(0,b.jsx)("option",{value:t,className:m?"bg-[#1a1625]":"bg-white",children:e},e))}),(0,b.jsx)("select",{value:h.getFullYear(),onChange:e=>{const t=parseInt(e.target.value);f(new Date(t,h.getMonth(),1))},className:"text-sm font-semibold bg-transparent border-none cursor-pointer focus:outline-none ".concat(m?"text-white":"text-gray-900"),children:S.map(e=>(0,b.jsx)("option",{value:e,className:m?"bg-[#1a1625]":"bg-white",children:e},e))})]}),(0,b.jsx)("button",{type:"button",onClick:()=>{f((0,i.P)(h,1))},className:"p-2 rounded-lg transition-colors ".concat(m?"text-[#B19CD9] hover:bg-[#B19CD9]/20":"text-[#9C7BD3] hover:bg-[#9C7BD3]/10"),children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),(0,b.jsx)(p,{selected:u,onSelect:e=>{x(e),e&&(d((0,s.GP)(e,"yyyy-MM-dd")),C())},month:h,isDarkMode:m,onTodayClick:e=>{const t=new Date(e.getFullYear(),e.getMonth(),1);f(t),x(e)}},h.toISOString()),(0,b.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,b.jsx)("button",{onClick:C,className:"flex-1 py-3 rounded-xl border transition-all font-medium ".concat(m?"border-[#B19CD9]/40 text-white/80 hover:text-white hover:bg-white/10":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"}),(0,b.jsx)("button",{onClick:()=>{u&&(d((0,s.GP)(u,"yyyy-MM-dd")),C())},disabled:!u,className:"flex-1 py-3 rounded-xl font-medium transition-all ".concat(u?"bg-gradient-to-r from-[#B19CD9] to-[#9C7BD3] text-white hover:shadow-[0_0_20px_rgba(177,156,217,0.5)]":m?"bg-[#B19CD9]/30 text-white/50 cursor-not-allowed":"bg-[#B19CD9]/30 text-gray-400 cursor-not-allowed"),children:"Confirm"})]})]})})]});return r.createPortal(N,document.body)}},3547(e,t,a){a.d(t,{A:()=>r});a(5043);var o=a(579);const r=e=>{let{title:t,description:a}=e;return(0,o.jsx)("div",{className:"w-full h-full flex flex-col items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center text-text-muted",children:[(0,o.jsx)("p",{className:"text-sm",children:t}),(0,o.jsx)("p",{className:"text-xs mt-1",children:a})]})})}},2639(e,t,a){a.d(t,{A:()=>l});var o=a(5043),r=a(3450),s=a(8907),n=a(8421),i=a(579);const l=e=>{let{isOpen:t,value:a,onChange:l,onClose:d,minDate:c,maxDate:m}=e;const{isDarkMode:u}=(0,n.DP)(),[x,g]=(0,o.useState)(a),[h,b]=(0,o.useState)(!1),[p,f]=(0,o.useState)(!1);(0,o.useEffect)(()=>{t&&(b(!0),f(!1),g(a))},[t,a]);const y=()=>{if(p)return;f(!0);const e=setTimeout(()=>{b(!1),f(!1),d()},200);return()=>clearTimeout(e)},{year:D,month:v,day:w}=(0,o.useMemo)(()=>{const[e,t,a]=x.split("-");return{year:e,month:t,day:a}},[x]),j=(0,o.useMemo)(()=>{const e=new Date(s.P.now()).getFullYear(),t=c?new Date(c).getFullYear():e-10,a=m?new Date(m).getFullYear():e+10;return Array.from({length:a-t+1},(e,a)=>String(t+a))},[c,m]),S=(0,o.useMemo)(()=>Array.from({length:12},(e,t)=>String(t+1).padStart(2,"0")),[]),C=(0,o.useMemo)(()=>new Date(parseInt(D),parseInt(v),0).getDate(),[D,v]),N=(0,o.useMemo)(()=>Array.from({length:C},(e,t)=>String(t+1).padStart(2,"0")),[C]),k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(!h)return null;const M=(e,t)=>{let a=parseInt(D),o=parseInt(v),r=parseInt(w);"year"===e&&(a=parseInt(t)),"month"===e&&(o=parseInt(t)),"day"===e&&(r=parseInt(t));const s=new Date(a,o,0).getDate();r>s&&(r=s);const n="".concat(a,"-").concat(String(o).padStart(2,"0"),"-").concat(String(r).padStart(2,"0"));g(n)};return(0,i.jsxs)("div",{className:"fixed inset-0 z-[10001] flex items-center justify-center p-4",children:[(0,i.jsx)("div",{className:"fixed inset-0 bg-black/40 ".concat(p?"backdrop-fade-out":"backdrop-fade-in"),style:{backdropFilter:"blur(8px)"},onClick:y}),(0,i.jsx)("div",{className:"relative w-full max-w-sm",children:(0,i.jsxs)("div",{className:"relative isolate rounded-2xl border shadow-2xl p-6 max-h-[90vh] overflow-y-auto transition-all ".concat(u?"border-[#B19CD9]/30 bg-gradient-to-b from-[#1a1625]/95 to-[#0d0a15]/95":"border-gray-200 bg-white"," ").concat(p?"modal-fade-out":"modal-content-fade-in"),children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)("h3",{className:"text-xl font-semibold ".concat(u?"text-white":"text-gray-900"),children:"Select Date"}),(0,i.jsx)("div",{className:"w-8"})]}),(0,i.jsx)("div",{className:"border-t mb-3 ".concat(u?"border-[#B19CD9]/20":"border-gray-200")}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-3 mb-4 px-4",children:[(0,i.jsx)(r.A,{value:v,onChange:e=>M("month",e),options:S,format:e=>k[parseInt(e)-1]}),(0,i.jsx)(r.A,{value:w,onChange:e=>M("day",e),options:N}),(0,i.jsx)(r.A,{value:D,onChange:e=>M("year",e),options:j})]}),(0,i.jsx)("div",{className:"border-t border-[#B19CD9]/20 my-3"}),(0,i.jsxs)("div",{className:"flex gap-3",children:[(0,i.jsx)("button",{onClick:y,className:"flex-1 py-3 rounded-xl border transition-all font-medium ".concat(u?"border-[#B19CD9]/40 text-white/80 hover:text-white hover:bg-white/10":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"}),(0,i.jsx)("button",{onClick:()=>{l(x),y()},className:"flex-1 py-3 rounded-xl bg-gradient-to-r from-[#B19CD9] to-[#9C7BD3] text-white font-medium hover:shadow-[0_0_20px_rgba(177,156,217,0.5)] transition-all",children:"Done"})]})]})})]})}},5644(e,t,a){a.d(t,{A:()=>l});var o=a(5043),r=a(7950),s=a(3450),n=a(8421),i=a(579);const l=e=>{let{isOpen:t,onSave:a,onClose:l,min:d=0,max:c=100,step:m=1,label:u="Select Dose",decimals:x=2,defaultValue:g,presets:h}=e;const{isDarkMode:b}=(0,n.DP)(),[p,f]=(0,o.useState)(g||"0.25"),[y,D]=(0,o.useState)(!1),[v,w]=(0,o.useState)(!1);(0,o.useEffect)(()=>{t?(D(!0),w(!1),f(g||"0.25")):y&&!v&&(w(!0),setTimeout(()=>{D(!1),w(!1)},200))},[t,g]);const j=(0,o.useMemo)(()=>{const e=parseFloat(p)||0,t=Math.floor(e);return{whole:t,decimal:Math.round((e-t)*Math.pow(10,x))}},[p,x]),S=(0,o.useMemo)(()=>Array.from({length:Math.floor((c-d)/m)+1},(e,t)=>String(d+t*m)),[d,c,m]),C=(0,o.useMemo)(()=>{const e=[];for(let t=0;t<Math.pow(10,x);t+=1)e.push(String(t).padStart(x,"0"));return e},[x]),N=(e,t)=>{let a=j.whole,o=j.decimal;"whole"===e?a=parseInt(t):o=parseInt(t);const r="".concat(a,".").concat(String(o).padStart(x,"0"));f(r)};if(!y)return null;const k=(0,i.jsxs)("div",{className:"fixed inset-0 z-[99999] flex items-center justify-center p-4",children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-black/60 ".concat(v?"backdrop-fade-out":"backdrop-fade-in"),style:{backdropFilter:"blur(8px)"},onClick:l}),(0,i.jsx)("div",{className:"relative w-full max-w-sm",children:(0,i.jsxs)("div",{className:"relative isolate rounded-2xl border shadow-2xl p-6 max-h-[90vh] overflow-y-auto transition-all ".concat(b?"border-[#B19CD9]/30 bg-gradient-to-b from-[#1a1625]/95 to-[#0d0a15]/95":"border-gray-200 bg-white"," ").concat(v?"modal-fade-out":"modal-content-fade-in"),children:[(0,i.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,i.jsx)("h3",{className:"text-xl font-semibold ".concat(b?"text-white":"text-gray-900"),children:u})}),(0,i.jsx)("div",{className:"border-t mb-3 ".concat(b?"border-[#B19CD9]/20":"border-gray-200")}),h&&h.length>0&&(0,i.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-4",children:h.map(e=>{const t=p===e;return(0,i.jsx)("button",{type:"button",onClick:()=>f(e),className:"px-2 py-1.5 text-xs rounded-lg transition-all duration-300 ".concat(t?"bg-gradient-to-r from-[#B19CD9] to-[#9C7BD3] text-white shadow-[0_0_15px_rgba(177,156,217,0.4)]":b?"bg-[#B19CD9]/10 text-[#B19CD9] border border-[#B19CD9]/30 hover:bg-[#B19CD9]/20":"bg-gray-100 text-gray-700 border border-gray-200 hover:bg-gray-200"),children:e},"preset-".concat(e))})}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-3 mb-4 px-2",children:[(0,i.jsx)(s.A,{value:String(j.whole),onChange:e=>N("whole",e),options:S}),(0,i.jsx)("span",{className:"text-2xl font-bold mt-6 ".concat(b?"text-white":"text-gray-900"),children:"."}),(0,i.jsx)(s.A,{value:String(j.decimal).padStart(x,"0"),onChange:e=>N("decimal",e),options:C})]}),(0,i.jsx)("div",{className:"border-t my-3 ".concat(b?"border-[#B19CD9]/20":"border-gray-200")}),(0,i.jsxs)("div",{className:"flex gap-3",children:[(0,i.jsx)("button",{onClick:l,className:"flex-1 py-3 rounded-xl border transition-all font-medium ".concat(b?"border-[#B19CD9]/40 text-white/80 hover:text-white hover:bg-white/10":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:"Cancel"}),(0,i.jsx)("button",{onClick:()=>{a(p),l()},className:"flex-1 py-3 rounded-xl bg-gradient-to-r from-[#B19CD9] to-[#9C7BD3] text-white font-medium hover:shadow-[0_0_20px_rgba(177,156,217,0.5)] transition-all",children:"Done"})]})]})})]});return r.createPortal(k,document.body)}},5109(e,t,a){a.d(t,{A:()=>s});a(5043);var o=a(8421),r=a(579);const s=e=>{let{value:t,onChange:a}=e;const{button:s}=(0,o.$E)();return(0,r.jsx)("div",{className:"flex justify-center mb-3",children:(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2 w-full",children:[{value:"week",label:"Week"},{value:"month",label:"Month"},{value:"90days",label:"90 Days"},{value:"all",label:"All Time"}].map(e=>(0,r.jsx)("button",{onClick:()=>a(e.value),className:"flex-1 px-2 py-2 text-sm rounded-lg transition-all duration-300 ".concat(t===e.value?"bg-gradient-to-r from-[#B19CD9] to-[#9C7BD3] text-white shadow-[0_0_15px_rgba(177,156,217,0.4)]":"bg-[#B19CD9]/10 text-[#B19CD9] border border-[#B19CD9]/30 hover:bg-[#B19CD9]/20 hover:shadow-[0_0_10px_rgba(177,156,217,0.3)]"),children:e.label},e.value))})})}},7012(e,t,a){a.d(t,{AB:()=>o,Rg:()=>s,f1:()=>r});const o=(e,t)=>{const{age:a,gender:o,height:r}=e;return"male"===o?10*t+6.25*r-5*a+5:10*t+6.25*r-5*a-161},r=(e,t)=>Math.round(e*t),s=(e,t,a)=>e.reduce((e,o)=>{const r=(a.getTime()-o.date.getTime())/36e5;if(r<0)return e;let s;if(r<24){const e=r/24;s=o.dose*e}else{const e=r-24,a=Math.exp(-.693*e/t);s=o.dose*a}return e+s},0)},7647(e,t,a){a.d(t,{Fr:()=>o});const o=()=>"undefined"!==typeof window&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<768)}}]);
//# sourceMappingURL=789.379849f5.chunk.js.map